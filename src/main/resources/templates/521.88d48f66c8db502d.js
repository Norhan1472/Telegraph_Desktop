"use strict";(self.webpackChunktelegraph=self.webpackChunktelegraph||[]).push([[521],{7521:(O,m,s)=>{s.r(m),s.d(m,{OutgoingModule:()=>_});var p=s(6814);const a=[{header:"\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0623\u0635\u0644\u0649",type:"text",id:"tghCode",name:"tghCode",for:"tghCode",defaultValue:null,isDropDown:!1,controlName:"tghCode",placeHolder:""},{header:"\u0627\u0644\u062f\u0648\u0644\u0629",type:"dropdown",id:"country",name:"country",for:"country",defaultValue:"EG",controlName:"country",isDropDown:{label:"englishName",options:[],value:"countryCode",placeHolder:"\u0627\u062e\u062a\u0631 \u0627\u0644\u062f\u0648\u0644\u0629"}},{header:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0625\u0631\u0633\u0627\u0644",type:"date",id:"tghDate",name:"tghDate",for:"tghDate",defaultValue:null,isDropDown:!0,controlName:"tghDate"},{header:" \u0643\u0648\u062f \u0627\u0644\u0645\u0648\u0638\u0641",type:"dropdown",id:"userCode",name:"userCode",for:"userCode",defaultValue:null,controlName:"userCode",isDropDown:{options:[],placeHolder:"select"}},{header:"\u0627\u0644\u0645\u062f\u064a\u0646\u0629",type:"dropdown",id:"city",name:"city",for:"city",defaultValue:null,controlName:"city",isDropDown:{label:"cityName",options:[],value:"cityCode",placeHolder:"select"}},{header:"\u0643\u0648\u062f \u0645\u0643\u062a\u0628 \u0627\u0644\u0648\u0631\u0648\u062f",type:"dropdown",id:"officeCode",name:"officeCode",for:"officeCode",defaultValue:null,controlName:"officeCode",isDropDown:{label:"officeName",options:[],value:"officeCode",placeHolder:"select"}},{header:"\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u062a\u062a\u0627\u0628\u0639\u0649",type:"number",id:"tghId",name:"tghId",for:"tghId",defaultValue:null,isDropDown:!1,controlName:"tghId"},{header:"\u0639\u0644\u0645 \u0627\u0644\u0648\u0635\u0648\u0644 ",type:"number",id:"deliveryNotice",name:"deliveryNotice",for:"deliveryNotice",defaultValue:null,isDropDown:!1,controlName:"deliveryNotice"},{header:"\u0625\u062f\u0627\u0631\u0649",type:"number",id:"admin",name:"admin",for:"admin",defaultValue:null,isDropDown:!1,controlName:"admin"}],D={tghDate:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0628\u0631\u0642\u064a\u0647",seqNo:"    \u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u062a\u062a\u0627\u0628\u0639\u0649",incomingSeq:"     \u0631\u0645\u0632 \u0627\u0644\u0648\u0631\u0648\u062f",tghCode:"\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0623\u0635\u0644\u0649",senderName:"   \u0627\u0644\u0631\u0627\u0633\u0644",recName:"\u0627\u0644\u0645\u0631\u0633\u0644 \u0625\u0644\u064a\u0647 ",address:" \u0627\u0644\u0639\u0646\u0648\u0627\u0646   ",status:" \u062d\u0627\u0644\u0629 \u0627\u0644\u0628\u0631\u0642\u064a\u0629  ",noOfWords:"\u0639\u062f\u062f \u0627\u0644\u0643\u0644\u0645\u0627\u062a",cost:" \u0627\u0644\u062a\u0643\u0644\u0641\u0647  ",sendDate:" \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0625\u0631\u0633\u0627\u0644  ",officeName:" \u0645\u0643\u062a\u0628 \u0627\u0644\u0648\u0631\u0648\u062f  ",outcomingSeq:" \u0631\u0645\u0632 \u0627\u0644\u0635\u0627\u062f\u0631  ",telNo:" \u0631\u0642\u0645 \u0627\u0644\u0645\u0628\u0644\u063a   "};var i=s(2029),d=s(5744),y=s(7650),f=s(265),h=s(8530),E=s(8209),e=s(1351),t=s(2403);let o=(()=>{class g{constructor(n,l,r,c,u){this.queueService=n,this.exportService=l,this.httpService=r,this.mtsModuleService=c,this.router=u,this.cols=[],this.countries=[],this.searchedData=[]}ngOnInit(){this.cols=a,this.form=this.mtsModuleService.create_form_by_cols(this.cols),this.queueService.getLookups(this.cols),this.createTableCols()}ngAfterViewInit(){console.log(this.form.value),this.getData({value:this.form.value})}createTableCols(){let n=[],l={field:"",header:"",display:1};for(let r in D)l.field=r,l.header=D[r],l.display=1,n.push(Object.assign({},l));this.tableCols=n,console.log(this.tableCols)}getData(n){this.loading=!0;let l=n.value;console.log(n.value),this.httpService.post("outComing/search",l).subscribe(r=>{this.loading=!1,this.searchedData=r.body?r.body:[]},r=>{this.loading=!1,this.searchedData=[]})}onAction(n){console.log("rowData",n);let l=n.value.seqNo;console.log(l),"Edit"==n.type&&this.router.navigate([`out/details/${l}`]),"Export"==n.type&&this.exportExcel()}exportExcel(){let n=document.createElement("table"),l=n.insertRow(),r=[];this.tableCols.forEach(c=>{r.push(c.field)});for(let c of r){let u=document.createElement("th");u.innerText=c,l.appendChild(u)}for(let c of this.searchedData){let u=n.insertRow();for(let b=0;b<r.length;b++)u.insertCell().innerText=c[r[b]]}console.log(r),console.log(n),this.exportService.export(n,"\u0627\u0644\u0635\u0627\u062f\u0631")}changeStatus(n){"country"==n.name&&(console.log(this.form.controls.country.value),this.queueService.setCityList(this.form.controls.country.value)),"city"!=n.name&&"country"!=n.name||this.queueService.setOfficeList(this.form.controls.city.value)}reset(){this.form.patchValue({country:"EG"}),this.searchedData=[]}static#e=this.\u0275fac=function(l){return new(l||g)(i.Y36(d.g),i.Y36(y.T),i.Y36(f.O),i.Y36(h._),i.Y36(E.F0))};static#t=this.\u0275cmp=i.Xpm({type:g,selectors:[["app-outgoing"]],decls:3,vars:10,consts:[[3,"reset","cols","form","nCols","action","onSubmit","selectedChange","onReset"],[3,"cols","data","show_edit","loading","show_export","btn_click"]],template:function(l,r){1&l&&(i.TgZ(0,"mts-form",0),i.NdJ("onSubmit",function(u){return r.getData(u)})("selectedChange",function(u){return r.changeStatus(u)})("onReset",function(){return r.reset()}),i.qZA(),i.TgZ(1,"mts-table",1),i.NdJ("btn_click",function(u){return r.onAction(u)}),i._uU(2," >"),i.qZA()),2&l&&(i.Q6J("reset",!0)("cols",r.cols)("form",r.form)("nCols",2)("action","search"),i.xp6(1),i.Q6J("cols",r.tableCols)("data",r.searchedData)("show_edit",!0)("loading",r.loading)("show_export",!0))},dependencies:[e.U,t.a]})}return g})();var v=s(4973);const C=[{path:"",component:o}];let _=(()=>{class g{static#e=this.\u0275fac=function(l){return new(l||g)};static#t=this.\u0275mod=i.oAB({type:g});static#o=this.\u0275inj=i.cJS({imports:[p.ez,E.Bz.forChild(C),v.m]})}return g})()},265:(O,m,s)=>{s.d(m,{O:()=>i});var p=s(3155),a=s(2029),D=s(9862);let i=(()=>{class d{constructor(f){this.httpClient=f}get(f){return this.httpClient.get(`${p.D.apiURL}/${f}`)}post(f,h){return this.httpClient.post(`${p.D.apiURL}/${f}`,h)}static#e=this.\u0275fac=function(h){return new(h||d)(a.LFG(D.eN))};static#t=this.\u0275prov=a.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},5744:(O,m,s)=>{s.d(m,{g:()=>f});var p=s(6223),a=s(7398),D=s(6814),i=s(2029),d=s(265),y=s(8209);let f=(()=>{class h{constructor(e,t){this.httpService=e,this.router=t,this.officelist=void 0,this.city=void 0,this.cols=[]}initForm(e){let o,t={};for(const v of e)t[v.name]=new p.NI(v.defaultValue||"",v.required?p.kI.required:null);return o=new p.cw(t),o}getLookups(e){this.cols=e;for(const t of this.cols)t.isDropDown&&("officeCode"==t.name?(console.log(this.city),this.getOffices(this.city).subscribe(o=>{console.log(o),t.isDropDown.options=o}),console.log(t.isDropDown.options)):"country"==t.name?this.getCountries().subscribe(o=>{t.isDropDown.options=o}):"userCode"==t.name?this.getUsers().subscribe(o=>{t.isDropDown.options=o}):"city"==t.name?(console.log(this.officelist),this.getCities(this.officelist).subscribe(o=>{this.city=o,console.log(this.city),t.isDropDown.options=this.city})):"status"==t.name?this.getStatus().subscribe(o=>{t.isDropDown.options=o,console.log(o)}):"lang"==t.name?this.getLang(this.officelist).subscribe(o=>{t.isDropDown.options=o}):"decoration"==t.name?t.isDropDown.options=this.getDecorations():"template"==t.name&&this.getTemplates().subscribe(o=>{console.log(o),t.isDropDown.options=o}));return null}getStatus(){return this.httpService.get("inComing/getStauts").pipe((0,a.U)(e=>(console.log(e),e)))}getCountries(){return this.httpService.get("Composer/getCountries").pipe((0,a.U)(e=>e.body))}getUsers(){let e=localStorage.getItem("office");return this.httpService.get(`Composer/getUsersName?office=${e}`).pipe((0,a.U)(t=>(console.log(t),t.body)))}getTemplates(){return this.httpService.get("inComing/getTemplates").pipe((0,a.U)(e=>e))}getCities(e){return this.httpService.get("Composer/InterCities"+(e=void 0!==e?`?code=${e}`:"?code=EG")).pipe((0,a.U)(t=>t.body))}setCityList(e){console.log("city fun",e),this.getCities(e).subscribe(t=>{this.city=t.body,console.log(t);for(let o of this.cols)"country"==o.name&&(this.cols[4].isDropDown.options=t,this.cols[5].isDropDown.options=null)})}getOffices(e){let t;return console.log("office fun",e,typeof e),console.log("-------------------------------------------"),e=void 0!==e&&"string"==typeof e?`${e}`:"",this.router.url.includes("in")?t="getPostalOffices":this.router.url.includes("out")&&(t="getOriginOffice"),this.httpService.get(`Composer/${t}?cityCode=${e}`).pipe((0,a.U)(o=>o.body))}setOfficeList(e){this.getOffices(e).subscribe(t=>{for(let o of this.cols)"city"==o.name&&(console.log(this.cols[5].isDropDown.options,this.cols[5].name),this.cols[5].isDropDown.options=t)})}getDecorations(){return[{label:"\u0628\u062f\u0648\u0646  ",value:0},{label:"\u0645\u0632\u0631\u0643\u0634",value:1},{label:"\u0645\u0632\u0631\u0643\u0634 \u0631\u062c\u0627\u0644 \u0623\u0639\u0645\u0627\u0644",value:2}]}getLang(e="EG"){return console.log("conntry",e),this.httpService.get(`Composer/getLanguage?countryCode=${e}`).pipe((0,a.U)(t=>t.body))}formatDate(e){return e=new D.uU("en-US").transform(e,"dd/MM/yyyy")?.toString(),console.log(e),e}static#e=this.\u0275fac=function(t){return new(t||h)(i.LFG(d.O),i.LFG(y.F0))};static#t=this.\u0275prov=i.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()}}]);
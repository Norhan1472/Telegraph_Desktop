"use strict";(self.webpackChunktelegraph=self.webpackChunktelegraph||[]).push([[617],{617:(Y,O,c)=>{c.r(O),c.d(O,{ComposerModule:()=>Et});var p=c(6814),e=c(2029),Z=c(9862),y=c(5619),C=c(8645),A=c(3155),_=c(8209);let g=(()=>{class i{setValidation(t,n){let s=this.validation.value;s[t]=n,this.validation.next(s)}constructor(t,n){this.http=t,this.activatedRoute=n,this.adminCheck=new y.X(!1),this.initTGHData=new C.x,this.avayaTelNo=new y.X({}),this.extrasender=new y.X(!1),this.extraRec=new y.X(!1),this.countryCode=new y.X("EG"),this.triffPlan=new C.x,this.cities=new C.x,this.isInOffice=new y.X(!1),this.vip=[],this.validation=new y.X({msg:!1,recName:!1,recAddress:!1,callerName:!1,telNo:!1,senName:!1,nationalId:!1,mobileNo:!1,email:!1}),this.isEdited=!1,this.initComposer(),this.checkUrl(),this.getCountryCode(),this.checkIfCallCenter()}checkIfCallCenter(){"TLG"===(localStorage.getItem("originOffice")||"")?this.isInOffice.next(!1):this.isInOffice.next(!0)}checkUrl(){this.activatedRoute.queryParams.subscribe(t=>{this.avayaTelNo.next(t.TelNo)})}initComposer(){}getRecepients(){return this.http.get("assets/recepients.json")}getChangeData(t,n=new Z.LE){return this.http.get(`${A.D.apiURL}/Composer/${t}`,{params:n})}getCountryCode(){this.countryCode.subscribe(t=>{this.getCities(t)})}getCities(t){this.getChangeData(`InterCities?code=${t}`).subscribe(n=>{n&&this.cities.next(n.body)})}getVip(t){this.getChangeData(`VIP?code=${t}`).subscribe(n=>{this.vip=n})}post(t,n){return this.http.post(`${A.D.apiURL}/Composer/${t}`,n)}isFormEdited(){return this.isEdited}set _isEdited(t){this.isEdited=t}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(Z.eN),e.LFG(_.gz))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var M=c(7417),m=c(7806);let q=(()=>{class i{constructor(t,n){this.composerService=t,this.translate=n}removeValidations(t,n=5e3){0!=n?setTimeout(()=>{t.forEach(s=>{this.composerService.setValidation(s,!1)})},n):t.forEach(s=>{this.composerService.setValidation(s,!1)})}convertBoolToInt(t){return Object.keys(t).forEach(n=>{"string"!=typeof t[n]&&(0==t[n]?t[n]=0:1==t[n]&&(t[n]=1))}),t}removeIds(t){t.forEach(n=>{delete n.id,delete n.officeName})}isValidFields(t){let n=!0;if(t.senders.length>0)for(let s=0;s<t.senders.length;s++)console.log(`obj.senders[${s}]`),console.log(t.senders[s]),""!==t.senders[s].mobileNo&&!this.isValid("mobileNo",t.senders[s].mobileNo)&&(this.composerService.setValidation("mobileNo",!0),n=!1),t.senders[s].nationalId&&""!==t.senders[s].nationalId&&!this.isValid("nationalId",t.senders[s].nationalId)&&(console.log(t.senders[s].nationalId),this.composerService.setValidation("nationalId",!0),n=!1),""!==t.senders[s].email&&!this.isValid("email",t.senders[s].email)&&(this.composerService.setValidation("email",!0),n=!1);if(t.recepients.length>0)for(let s=0;s<t.recepients.length;s++)""!==t.recepients[s].telNo&&!this.isValid("telNo",t.recepients[s].telNo)&&(this.composerService.setValidation("telNo",!0),n=!1),1==t.recepients[s].recVip&&!t.recepients[s].vipNo&&(this.composerService.setValidation("recVip",!0),n=!1);return n}isValid(t,n=""){let s=!0;if("mobileNo"===t){if(String(n).startsWith("01")||String(n).startsWith("02")){if(console.log("value started by 01 or 02"),!String(n).startsWith("01"))return console.log(0==n.length),console.log("value started by02x"),10==n.length&&console.log("value 10 numbers"),10==n.length;if(console.log("value started by 01"),String(n).startsWith("010")||String(n).startsWith("011")||String(n).startsWith("012")||String(n).startsWith("015"))return console.log("value started by01x"),11==n.length&&console.log("value 11 numbers"),console.log(0==n.length),11==n.length||0==n.length}return console.log(0==n.length),0==n.length||null==n}if("nationalId"==t&&(n.startsWith("0")||14!==n.length))return console.log("nationalId"),console.log(n),console.log(0==n.length),!1;if("email"==t){const r=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(n);return console.log(0==n.length),r||0==n.length}return"telNo"!=t||(n.startsWith("02")&&10==n.length||(n.startsWith("010")||n.startsWith("011")||n.startsWith("012")||n.startsWith("015"))&&11==n.length||0==n.length?s=!0:(s=!1,console.log(s)),s)}checkRequiredValidations(t){let n=!0;if([{name:"msg",value:t.message},{name:"callerName",value:t.callerName}].forEach(o=>{this.nullOrUndefined(o.value)&&(this.composerService.setValidation(o.name,!0),n=!1)}),(0==t.senders.length||0==t.recepients.length)&&(n=!1),t.senders.length>0)for(let o=0;o<t.senders.length;o++)this.nullOrUndefined(t.senders[o].senderName)&&(this.composerService.setValidation("senName",!0),n=!1);if(t.recepients.length>0)for(let o=0;o<t.recepients.length;o++)this.nullOrUndefined(t.recepients[o].recName)&&(this.composerService.setValidation("recName",!0),n=!1),this.nullOrUndefined(t.recepients[o].address)&&(this.composerService.setValidation("recAddress",!0),n=!1);return n}getDir(){return"ar"===this.translate.currentLang?"rtl":"ltr"}nullOrUndefined(t){return null==t||null==t||""==t}handleRecepients(t){t?.map(n=>{delete n.fees,"object"==typeof n.address&&(n.address=n?.address?.keywordName),n.senderResp=n.senderResp?1:0,n.recVip=n.recVip?1:0,n.cityCode=n.cityCode?.cityCode?n.cityCode?.cityCode:null})}isHidden(t){return null!=t&&null!=t&&0!=t?"display: inline;":"display: none;visibility: hidden"}handlePostObject(t){return this.removeIds(t?.senders),this.removeIds(t?.recepients),this.convertBoolToInt(t)}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(g),e.LFG(m.sK))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),U=(()=>{class i{constructor(t){this.composerService=t}performPrint(t){let n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n);let s=n?.contentWindow?.document;s?.open(),s?.write(t),s?.close(),setTimeout(()=>{n.contentWindow?.focus(),n.contentWindow?.print()},1e3)}getPrintData(t){this.composerService.post("printCalculateCost",t).subscribe({next:s=>{this.printCost(s.body)},error:s=>{},complete:()=>{}})}printCost(t){let n="";for(let o=0;o<t?.messages?.length;o++){n+=`<div style="display: flex;flex-direction: row;justify-content: space-between;direction: rtl;\n      line-height: 0px;width: 90%; ">\n\n      <p>\u0631\u0642\u0645 \u0627\u0644\u0628\u0631\u0642\u064a\u0629</p>\n      <p>${o+1}</p>\n      </div>`;let r=t?.messages[o];for(let d in r)n+=`<div style="display: flex;flex-direction: row;justify-content: space-between;direction: rtl;\n          line-height: 0px;width: 100%; white-space: nowrap;  word-wrap: break-word;  flex-wrap: wrap;overflow-y:inherit;overflow-wrap: break-word;\n          white-space: pre; ">\n\n            <p>\n              ${d.toString().replaceAll("_"," ")}\n            </p>\n            <p   style=" overflow-wrap: break-word;\n                        white-space: pre;\n\n             max-width:100%;   ">\n            ${r[d]}\n            </p>\n          </div>`;n+="<p>-------------------------------------------------------------------------------------------------------</p>"}let s="";s+=`\n\n\n\n    <div\n    class="article"\n    id="printDiv"\n    style="height: 95%; direction: rtl; line-height: 0px"\n  >\n    <div\n      style="\n        width: 90%;\n        border: 1px solid gray;\n\n        height: 100%;\n        padding: 10px 30px;\n        direction: ltr;\n      "\n    >\n      <div >\n        <div\n          style="\n            display: flex;\n            flex-direction: row;\n            direction: ltr;\n            line-height: 0px;\n            width: 80%;\n            justify-content: space-between;\n          "\n        >\n        <div>\n          <img\n            style="\n              width: 150px;\n              height: 50px;\n\n              margin-bottom: 40px;\n            "\n            src="assets/images/weLogo.jpg"\n          />\n        </div>\n          <div>\n            <div style="display: flex; justify-content: space-between">\n\n              <p style="float: left">${t?.officeName}</p>\n              <p style="float: right">${t?.date}</p>\n            </div>\n            <div>\n            <p>\n            \u0645\u0644\u0627\u062d\u0638\u0629 \u0642\u064a\u0645\u0629 \u0639\u0646\u0627\u0635\u0631 \u0627\u0644\u0628\u0631\u0642\u064a\u0629 \u0628\u0627\u0644\u0642\u0631\u0634\n          </p>\n            </div>\n          </div>\n\n        </div>\n      </div>\n\n      <div\n        style="\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          direction: rtl;\n          line-height: 0px;\n          width: 90%;\n        "\n      ></div>\n      <div\n        style="\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          direction: rtl;\n          line-height: 0px;\n          width: 90%;\n        "\n      >\n        <p>\u062e\u0637\u0629 \u0627\u0644\u0623\u0633\u0639\u0627\u0631</p>\n        <p>${t?.planName}</p>\n      </div>\n      <div\n        style="\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          direction: rtl;\n          line-height: 0px;\n          width: 90%;\n        "\n      >\n        <p>\u0633\u0639\u0631 \u0627\u0644\u0643\u0644\u0645\u0629</p>\n        <p>${t?.wordPrice}</p>\n      </div>\n      <div\n        style="\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          direction: rtl;\n          line-height: 0px;\n          width: 90%;\n        "\n      >\n        <p>\u0648\u0642\u062a \u0627\u0644\u062a\u062d\u0635\u064a\u0644</p>\n        <p>${t?.time}</p>\n      </div>\n      <p>--------------------------------------------------------------------------------------------</p>\n\n<div style=" display:flex ;flex-wrap: wrap;">\n${n}\n</div>\n\n\n      <div\n        style="\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          direction: rtl;\n          line-height: 0px;\n          width: 90%;\n        "\n      >\n        <p>\u0627\u0644\u0627\u062c\u0645\u0627\u0644\u0649</p>\n        <p>${t.totalCost}</p>\n      </div>\n    </div>\n  </div>\n      `;try{setTimeout(()=>{this.performPrint(s)},1e3)}catch(o){console.error("An error occurred while printing:",o)}}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(g))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var N=c(8981);let L=(()=>{class i{constructor(){this.createBody=[],this.genId=0,this.telNo=0,this.requiredValidations=["msg","recName","recAddress","callerName","telNo","senName"],this.printCostObj={},this.costObject={}}static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var l=c(6223);let T=(()=>{class i{constructor(t){this.fb=t,this.recepients=[],this.senders=[],this.initMessageForm(),this.initTghDetailsForm()}clear(){this.initMessageForm(),this.initTghDetailsForm(),this.recepients=[],this.senders=[]}initMessageForm(){this.messageForm=this.fb.group({template:this.fb.control(0),tempTypeCode:this.fb.control({value:"0",disabled:!0}),tempCode:this.fb.control({value:null,disabled:!0}),message:this.fb.control(null),decoration:this.fb.control(0),deliveryNotic:this.fb.control(0),urgent:this.fb.control(0),sms:this.fb.control(0)})}initTghDetailsForm(){this.tghDetailsForm=this.fb.group({userCode:this.fb.control(null),callerName:this.fb.control(null),admin:this.fb.control(0),planCode:this.fb.control(null,l.kI.required),sendDate:this.fb.control(new Date),notes:this.fb.control(null),countryCode:this.fb.control(null,l.kI.required),international:this.fb.control(0),callerTelNo:this.fb.control({value:null,disabled:!0}),langCode:this.fb.control("en"),callDate:this.fb.control(null)})}get getMessageForm(){return this.messageForm}set setMessageForm(t){this.messageForm=t}get getTghDetailsForm(){return this.tghDetailsForm}set setTghDetailsForm(t){this.tghDetailsForm=t}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(l.qu))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var K=c(4310),F=c(737),E=c(3997),V=c(9773),z=c(265),S=c(5444),b=c(3696),R=c(5969),k=c(3236),I=c(5783);function W(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",17)(1,"label",28),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"input",29),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.admin=s)})("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.changeAdminValue(s))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,3,"composer.tghDetails.admin")," :"),e.xp6(2),e.Q6J("disabled",!0)("ngModel",t.admin)}}const X=function(){return{standalone:!0}},ee=function(i,a){return{left:i,right:a}};let te=(()=>{class i{constructor(t,n,s,o,r,d,h){this.fb=t,this.composerService=n,this.changeDetectorRef=s,this.httpService=o,this.translateService=r,this.sectionData=d,this.permissionsService=h,this.planList=[],this.sendDate=new Date,this.countryAndPlanObject={ActionFrom:"",internationalFlag:0,adminFlag:0,countryCode:"EG",planCode:"UN2"},this.disabledDates=[],this.languageList=[],this.isInOffice=!1,this.today=new Date,this.formFocusd=!1,this.ngUnsubscribe=new C.x,this.admin=!1,this.international=!1,this.firstTime=!0,this.setDraft=!1,this.composerService.isInOffice.subscribe(f=>{this.originOffice=localStorage.getItem("office")||null,this.isInOffice=f})}getLanguageList(t){this.languageList=["ar","en"],this.composerService.getChangeData(`getLanguage?countryCode=${t}`).subscribe(s=>{this.languageList=s.body},s=>{this.languageList=[]})}ngOnInit(){this.composerService.validation.subscribe(n=>{this.v=n}),this.tghDetailsForm=this.sectionData.getTghDetailsForm;let t={countryCode:"EG",countryName:"\u0645\u0635\u0631",destInd:"\u0641\u062b\u0635\u0635",active:1,capital:"Egypt",international:0,englishName:"Egypt",destIndEng:"UNCX"};this.tghDetailsForm.patchValue({countryCode:t}),this.changeCountry(t),this.trackChanging(),this.user=this.permissionsService.getUserName()}handleFocus(t){this.formFocusd&&(this.formFocusd=!0)}trackChanging(){setTimeout(()=>{this.tghDetailsForm.markAsPristine();let t=this.tghDetailsForm.valueChanges.pipe((0,E.x)(),(0,V.R)(this.ngUnsubscribe)).subscribe(()=>{!this.tghDetailsForm.pristine&&this.formFocusd&&(this.composerService._isEdited=!0,console.log("form is modified"),t.unsubscribe())})},1e3)}setDraftData(t){this.setDraft=!0,console.log("set draft");let n=this.countries?.find(s=>s.countryCode==t.countryCode);this.genId=t.genId,this.composerService.countryCode.next(t.countryCode),this.callDate=t.callDate,this.sendDate=t.sendDate,this.tghDetailsForm.patchValue("0"==t.international?{international:!1}:{international:!0}),"0"==t.admin?(this.admin=!1,this.composerService.adminCheck.next(!1)):(this.admin=!0,this.composerService.adminCheck.next(!0)),this.tghDetailsForm.controls.callerTelNo.disable(),this.tghDetailsForm.patchValue({genId:t.genId,userCode:t.userCode,callerName:t.callerName,notes:t.notes,countryCode:n,callerTelNo:t.callerTelNo,langCode:t.langCode}),setTimeout(()=>{this.tghDetailsForm.patchValue({planCode:t.planCode})},500),console.log(t.planCode,this.planList),setTimeout(()=>{this.composerService._isEdited=this.formFocusd=!1},500)}getInitData(){this.composerService.getChangeData("IntiateTGH").subscribe(t=>{t&&(this.data=t.body)})}ngAfterViewInit(){this.changeDetectorRef.detectChanges(),this.checkTelAvaya()}checkTelAvaya(){return this.composerService.avayaTelNo.subscribe(t=>{t?(this.tghDetailsForm.patchValue({callerTelNo:t}),this.getAvayaCallerName(t)):this.tghDetailsForm.patchValue({callerTelNo:null,callerName:null})})}getAvayaCallerName(t){this.composerService.getChangeData(`GetCallerName?telNo=${t}`).subscribe(n=>{n&&this.setAvayaCallerName(n.body)})}setAvayaCallerName(t){this.tghDetailsForm.patchValue({callerName:t})}changeAdminValue(t){console.log("changeAdminValue",t),this.composerService.adminCheck.next(t),this.firstTime||this.getPlans(),setTimeout(()=>{this.firstTime=!1},1e3)}changeCountry(t){this.getPlans(),this.composerService.countryCode.next(t.countryCode),this.tghDetailsForm.patchValue({international:t.international}),1==t.international&&this.tghDetailsForm.patchValue({admin:0}),this.getLanguageList(t.countryCode)}getPlans(){console.log("get plaaaaaaaaannnnnnnnn");let t=this.tghDetailsForm.controls.admin.value,n=this.tghDetailsForm.controls.countryCode?.value?.countryCode;t=t?1:0,n&&this.httpService.get(`Queue/getPlans?countryCode=${n}&admin=${t}`).subscribe(s=>{if(s.body.length>0){if(this.planList=s.body,console.log(this.planList),console.log(this.setDraft),!this.setDraft){console.log("here");let o=this.planList.find(r=>"1"===r.DEFAULT_PLAN);setTimeout(()=>{this.tghDetailsForm.patchValue({planCode:o?.PLAN_CODE})},0)}}else this.planList=[]},s=>{this.planList=[]}),console.log(this.tghDetailsForm.controls.planCode.value)}getPlanCode(t){let n=this.planList.find(s=>s.PLAN_CODE==t);this.setMessageData(n)}setMessageData(t){let n=["DEFAULT_PLAN","PLAN_CODE","PLAN_NAME"],s={...t};for(let o in n)delete s[n[o]];this.composerService.triffPlan.next(s)}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(l.qu),e.Y36(g),e.Y36(e.sBO),e.Y36(z.O),e.Y36(m.sK),e.Y36(T),e.Y36(N.q))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-telegraph-details"]],inputs:{genId:"genId",callDate:"callDate",countries:"countries"},decls:76,vars:69,consts:[[1,"mt-4"],[3,"multiple"],[3,"header","selected"],[1,"row",2,"margin","10px 0",3,"formGroup","click"],[1,"col-lg-10"],[1,"tgh-details"],[1,"label"],[3,"ngClass"],["type","text","pInputText","","formControlName","callerTelNo"],[1,"",3,"ngClass"],["type","text","pInputText","","formControlName","callerName",3,"disabled"],["callerNameVal",""],["style","flex-direction: column;align-items: flex-start;justify-content: space-around;",4,"ngIf"],[2,"margin-bottom","3px"],["optionLabel","PLAN_NAME","formControlName","planCode","optionValue","PLAN_CODE",3,"options","ngModelChange"],[1,""],["formControlName","langCode",3,"options"],[2,"flex-direction","column","align-items","flex-start","justify-content","space-around"],["type","date","dateFormat","yy-mm-dd","appendTo","body",3,"showIcon","ngModel","ngModelOptions","minDate","ngModelChange"],[1,"col","details-info","flex"],[1,"p-float-label","w-100"],["inputId","description","rows","2","pInputTextarea","","formControlName","notes",2,"margin-right","8px"],["for","description"],[1,"col-lg-2","International-Info"],[2,"font-weight","bolder"],[2,"display","flex","flex-direction","column"],[1,"me-2",2,"margin-bottom","3px"],["optionLabel","englishName","formControlName","countryCode",3,"options","filter","ngModelChange"],["for","binary"],["id","binary","type","checkbox","formControlName","admin",1,"form-check-input",3,"disabled","ngModel","ngModelChange"]],template:function(n,s){if(1&n&&(e.TgZ(0,"div",0)(1,"p-accordion",1)(2,"p-accordionTab",2),e.ALo(3,"translate"),e.TgZ(4,"form",3),e.NdJ("click",function(r){return s.handleFocus(r)}),e.TgZ(5,"div",4)(6,"div",5)(7,"div")(8,"span",6),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"span"),e._uU(12),e.qZA()(),e.TgZ(13,"div")(14,"span",6),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"span"),e._uU(18),e.qZA()(),e.TgZ(19,"div")(20,"span",6),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"span"),e._uU(24),e.qZA()(),e.TgZ(25,"div")(26,"span",6),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"span"),e._uU(30),e.ALo(31,"date"),e.qZA()(),e.TgZ(32,"div")(33,"span")(34,"label",7),e._uU(35),e.ALo(36,"translate"),e.qZA(),e._UZ(37,"input",8),e.qZA()(),e.TgZ(38,"div")(39,"span")(40,"label",9),e._uU(41),e.ALo(42,"translate"),e.qZA(),e._UZ(43,"input",10,11),e.qZA()(),e.YNc(45,W,5,5,"div",12),e.TgZ(46,"div",13)(47,"label"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.TgZ(50,"p-dropdown",14),e.NdJ("ngModelChange",function(r){return s.getPlanCode(r)}),e.qZA()(),e.TgZ(51,"div")(52,"label",15),e._uU(53),e.ALo(54,"translate"),e.qZA(),e._UZ(55,"p-dropdown",16),e.qZA(),e.TgZ(56,"div",17)(57,"label",15),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.TgZ(60,"p-calendar",18),e.NdJ("ngModelChange",function(r){return s.sendDate=r}),e.qZA()(),e.TgZ(61,"div",19)(62,"span",20),e._UZ(63,"textarea",21),e.TgZ(64,"label",22),e._uU(65),e.ALo(66,"translate"),e.qZA()()()()(),e.TgZ(67,"div",23)(68,"p",24),e._uU(69),e.ALo(70,"translate"),e.qZA(),e.TgZ(71,"div",25)(72,"label",26),e._uU(73),e.ALo(74,"translate"),e.qZA(),e.TgZ(75,"p-dropdown",27),e.NdJ("ngModelChange",function(r){return s.changeCountry(r)}),e.qZA()()()()()()()),2&n){const o=e.MAs(44);e.xp6(1),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("header",e.lcZ(3,36,"composer.tghDetails.title"))("selected",!0),e.xp6(2),e.Q6J("formGroup",s.tghDetailsForm),e.xp6(5),e.hij(" ",e.lcZ(10,38,"composer.tghDetails.id")," :"),e.xp6(3),e.hij(" ",s.genId,""),e.xp6(3),e.hij("",e.lcZ(16,40,"composer.tghDetails.user")," :"),e.xp6(3),e.hij(" ",s.user,""),e.xp6(3),e.hij("",e.lcZ(22,42,"composer.tghDetails.originOffice")," : "),e.xp6(3),e.hij(" ",s.originOffice,""),e.xp6(3),e.hij("",e.lcZ(28,44,"composer.tghDetails.callDate")," :"),e.xp6(3),e.hij(" ",e.xi3(31,46,s.callDate,"dd/MM/yyyy HH:mm"),""),e.xp6(4),e.Q6J("ngClass","ar"==s.translateService.currentLang?"ar-label":"en-label"),e.xp6(1),e.hij("",e.lcZ(36,49,"composer.tghDetails.telNo")," :"),e.xp6(5),e.Q6J("ngClass","ar"==s.translateService.currentLang?"ar-label":"en-label"),e.xp6(1),e.hij(" ",e.lcZ(42,51,"composer.tghDetails.callerName")," : "),e.xp6(2),e.Tol(s.v.callerName&&""==o.value?"danger-border":""),e.Q6J("disabled",!0),e.xp6(2),e.Q6J("ngIf",0==s.tghDetailsForm.controls.countryCode.value.international),e.xp6(3),e.hij("",e.lcZ(49,53,"composer.tghDetails.plan")," :"),e.xp6(2),e.Q6J("options",s.planList),e.xp6(3),e.hij("",e.lcZ(54,55,"composer.tghDetails.langCode")," :"),e.xp6(2),e.Q6J("options",s.languageList),e.xp6(3),e.hij("",e.lcZ(59,57,"composer.tghDetails.sendDate")," :"),e.xp6(2),e.Q6J("showIcon",!0)("ngModel",s.sendDate)("ngModelOptions",e.DdM(65,X))("minDate",s.today),e.xp6(4),e.Akn(e.WLB(66,ee,"ar"==s.translateService.currentLang?"unset":"0.75rem","ar"==s.translateService.currentLang?"0.75rem":"unset")),e.xp6(1),e.Oqu(e.lcZ(66,59,"composer.tghDetails.notes")),e.xp6(4),e.hij(" ",e.lcZ(70,61,"composer.tghDetails.internationalInfo.international")," : "),e.xp6(4),e.hij("",e.lcZ(74,63,"composer.tghDetails.internationalInfo.country")," :"),e.xp6(2),e.Q6J("options",s.countries)("filter",!0)}},dependencies:[p.mk,p.O5,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.On,l.sg,l.u,S.Lt,b.UQ,b.US,R.o,k.f,I.g,p.uU,m.X$],styles:[".details-info[_ngcontent-%COMP%]{margin-top:15px}.details-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{font-weight:bolder}.details-info[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%}  .p-accordion .p-accordiontab .p-accordion-tab{font-weight:500}.ar-label[_ngcontent-%COMP%]{right:.75rem;left:0}.en-label[_ngcontent-%COMP%]{left:.75rem;right:0}.label[_ngcontent-%COMP%]{font-weight:600}.ju-start[_ngcontent-%COMP%]{direction:rtl}.ju-end[_ngcontent-%COMP%]{direction:ltr}.International-Info[_ngcontent-%COMP%]{padding:8px 12px;border-radius:9px;box-shadow:0 0 11px #d3cfcf;margin:0 auto}  .p-card .p-card-body{padding:0 10px}  .p-dropdown{width:calc(100% - 75px)}.danger-border[_ngcontent-%COMP%]{border:1px solid red}.form-check-input[type=checkbox][_ngcontent-%COMP%]{border-radius:50%;width:25px;height:25px;min-height:25px!important;margin:0 .75rem;border-color:#a5a5a5;cursor:pointer}.labels[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{font-weight:400!important}label[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:0 5px}input[_ngcontent-%COMP%]{height:30px}.p-dropdown[_ngcontent-%COMP%]{width:calc(100% - 75px)!important}.tgh-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap;gap:0 10px}.tgh-details[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.p-float-label[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%]{top:-1.25rem}"]})}return i})();const ne=["recName","recName2","cityCode","address","addressDetails","postalOffice","officeName","officeCode","telNo"],se=[{field:"recVip",headerEn:"VIP",headerAr:"\u0634\u062e\u0635\u064a\u0629 \u0647\u0627\u0645\u0629",display:1,type:"check",value:!1},{field:"vipNo",headerEn:"VIP List",headerAr:"\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0634\u062e\u0635\u064a\u0627\u062a \u0627\u0644\u0647\u0627\u0645\u0629",display:1,type:"select",value:0},{field:"recName",headerEn:"Rec Name",headerAr:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0631\u0633\u0644 \u0627\u0644\u064a\u0647",display:1,type:"textarea",value:""},{field:"recName2",headerEn:"Extra Recepient",headerAr:"\u0627\u0644\u0645\u0631\u0633\u0644 \u0627\u0644\u064a\u0647 \u0627\u0644\u0627\u0636\u0627\u0641\u064a",display:1,type:"textarea",value:""},{field:"postalOffice",headerEn:"Postal Office",headerAr:"\u0635. \u0628",display:1,type:"number",value:""},{field:"cityCode",headerEn:"City",headerAr:"\u0627\u0644\u0645\u062f\u064a\u0646\u0629",display:1,type:"select",value:""},{field:"address",headerEn:"Address",headerAr:"\u0627\u0644\u0639\u0646\u0648\u0627\u0646",display:1,type:"autoComplete",value:""},{field:"officeCode",headerEn:"Office Name",headerAr:"\u0627\u0644\u0645\u0643\u062a\u0628",display:1,type:"select",value:""},{field:"addressDetails",headerEn:"Address Details",headerAr:"\u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0639\u0646\u0648\u0627\u0646",display:1,type:"textarea",value:""},{field:"telNo",headerEn:"Tel NO.",headerAr:"\u0631\u0642\u0645 \u0627\u0644\u062a\u0644\u064a\u0641\u0648\u0646",display:1,type:"number",value:0},{field:"fees",headerEn:"Extra Fees",headerAr:"\u062a\u0643\u0644\u0641\u0629 \u0627\u0636\u0627\u0641\u064a\u0629",display:1,type:"number",value:0},{field:"senderResp",headerEn:"Sender Responsibility",headerAr:"\u0645\u0633\u0624\u0644\u064a\u0629 \u0627\u0644\u0631\u0627\u0633\u0644",display:1,type:"check",value:!1}];var v=c(9972),ie=c(8980),$=c(8834),x=c(7706),oe=c(1447);function re(i,a){if(1&i&&(e.TgZ(0,"th",12),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.headerAr," ")}}function ae(i,a){if(1&i&&(e.ynx(0),e.YNc(1,re,2,1,"th",11),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function le(i,a){if(1&i&&(e.TgZ(0,"th",14),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.headerEn," ")}}function ce(i,a){if(1&i&&e.YNc(0,le,2,1,"th",13),2&i){const t=e.oxw().$implicit;e.Q6J("ngForOf",t)}}function de(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"th",7)(2,"i",8),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.openNew())}),e.ALo(3,"translate"),e.qZA()(),e.YNc(4,ae,2,1,"ng-container",9),e.YNc(5,ce,1,1,"ng-template",null,10,e.W1O),e.qZA()}if(2&i){const t=e.MAs(6),n=e.oxw();e.xp6(1),e.Akn("ar"==n.translateService.currentLang?"right:0 !important":"left:0 !important"),e.xp6(1),e.Q6J("pTooltip",e.lcZ(3,5,"composer.recepients.addRec")),e.xp6(2),e.Q6J("ngIf","ar"==n.translateService.currentLang)("ngIfElse",t)}}function pe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",27),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)})("ngModelChange",function(s){e.CHM(t);const o=e.oxw(2).rowIndex,r=e.oxw();return r.changeVipMode(s,o),e.KtG(r.flag&&r.fieldEdited())}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.Q6J("ngModel",n[t.field])}}const he=function(){return{width:"180px",height:"37.6px"}};function ge(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"p-dropdown",28),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw(2).$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)})("ngModelChange",function(s){e.CHM(t);const o=e.oxw(3).rowIndex,r=e.oxw();return r.setVipData(s,o),e.KtG(r.flag&&r.fieldEdited())}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).$implicit,n=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Akn(e.DdM(7,he)),e.Q6J("ngClass","recVip")("appendTo","body")("ngClass",n.recVip&&!n.vipNo?"danger-border2":"")("options",s.vip)("ngModel",n[t.field])}}const me=function(){return{width:"180px",hight:"37.6px"}},ue=function(){return[]};function fe(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"p-dropdown",29),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(4);return e.KtG(s.flag&&s.fieldEdited())}),e.qZA(),e.BQk()}2&i&&(e.xp6(1),e.Akn(e.DdM(4,me)),e.Q6J("disabled",!0)("options",e.DdM(5,ue)))}function _e(i,a){if(1&i&&(e.ynx(0),e.YNc(1,ge,2,8,"ng-container",20),e.YNc(2,fe,2,6,"ng-container",20),e.BQk()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",t.recVip),e.xp6(1),e.Q6J("ngIf",!t.recVip)}}const Ce=function(){return{standalone:!0}};function xe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",30),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.Q6J("ngModel",n[t.field])("ngModelOptions",e.DdM(2,Ce))}}const B=function(){return{width:"180px"}};function ye(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"p-dropdown",31),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)})("ngModelChange",function(s){e.CHM(t);const o=e.oxw(2).rowIndex,r=e.oxw();return r.setOffices(s,o),e.KtG(r.flag&&r.fieldEdited())}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.Akn(e.DdM(7,B)),e.Q6J("filter",!0)("appendTo","body")("options",s.currentCities)("ngModel",n[t.field])("showClear",!0)}}function be(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"p-dropdown",32),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw(),s=n.rowIndex,o=n.$implicit,r=e.oxw();e.Akn(e.DdM(7,B)),e.Q6J("filter",!0)("appendTo","body")("options",r.getCityOfficesDataByIndex(s))("ngModel",o[t.field])("showClear",!0)}}function Te(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"textarea",33),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e._uU(1,"              "),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.Tol(!s.v.recName||"recName"!=t.field||""!=n[t.field]&&null!=n[t.field]&&null!=n[t.field]?"":"danger-border"),e.Udp("width","recName2"!=t.field||s.enableExtraRec?"150":"100","px"),e.Q6J("disabled","recName2"==t.field&&!s.enableExtraRec)("ngModel",n[t.field])("value",n[t.field])}}function ve(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",34)(2,"p-autoComplete",35),e.NdJ("completeMethod",function(s){e.CHM(t);const o=e.oxw(2).rowIndex,r=e.oxw();return e.KtG(r.filterItems(s,o))})("onSelect",function(s){e.CHM(t);const o=e.oxw(2).rowIndex,r=e.oxw();return e.KtG(r.filteroffices(s,o))})("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Tol(!s.v.recAddress||"address"!=t.field||""!=n[t.field]&&null!=n[t.field]&&null!=n[t.field]?"black-border":"danger-border"),e.xp6(1),e.Q6J("disabled",!n.cityCode)("suggestions",s.officesListKeyes)("ngModel",n[t.field])}}function De(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",36),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)})("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.Q6J("ngModel",n[t.field])}}function Ze(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",37),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)})("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.Tol("telNo"==t.field&&s.v.telNo?"danger-border":""),e.Q6J("disabled","fees"==t.field)("ngModel",n[t.field])("pKeyFilter","number"==t.type?"int":"")}}function Me(i,a){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,pe,1,1,"input",19),e.YNc(2,_e,3,2,"ng-container",20),e.YNc(3,xe,1,3,"input",21),e.YNc(4,ye,1,8,"p-dropdown",22),e.YNc(5,be,1,8,"p-dropdown",23),e.YNc(6,Te,2,7,"textarea",24),e.YNc(7,ve,3,5,"ng-container",20),e.YNc(8,De,1,1,"input",25),e.YNc(9,Ze,1,5,"input",26),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf","recVip"==t.field),e.xp6(1),e.Q6J("ngIf","vipNo"===t.field),e.xp6(1),e.Q6J("ngIf","senderResp"==t.field),e.xp6(1),e.Q6J("ngIf","cityCode"===t.field),e.xp6(1),e.Q6J("ngIf","officeCode"===t.field),e.xp6(1),e.Q6J("ngIf","textarea"==t.type),e.xp6(1),e.Q6J("ngIf","autoComplete"==t.type),e.xp6(1),e.Q6J("ngIf","text"==t.type),e.xp6(1),e.Q6J("ngIf","number"==t.type)}}function we(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",15)(2,"button",16),e.NdJ("click",function(){const o=e.CHM(t).rowIndex,r=e.oxw();return e.KtG(r.deleteRecepient(o))}),e._UZ(3,"i",17),e.qZA()(),e.YNc(4,Me,10,9,"td",18),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Akn("ar"==t.translateService.currentLang?"right:0 !important;":"left:0 !important"),e.xp6(1),e.Tol(t.recepients.length<2?"not-allow-cursor":""),e.Q6J("disabled",1==t.recepients.length),e.xp6(2),e.Q6J("ngForOf",t.cols)}}const Oe=function(){return{width:"450px"}};let Ae=(()=>{class i{get selectedColumns(){return this._selectedColumns}constructor(t,n,s,o,r,d){this.composerService=t,this.messageService=n,this.confirmationService=s,this.cdr=o,this.dataShared=r,this.translateService=d,this.viewOverlay=!1,this.globalFilterFields=ne,this.orginalOfficeList=[],this.officesListKeyes=[],this.recepientDialog=!1,this.recepients=[],this.selectedRecepients=[],this.submitted=!1,this.cols=[],this._selectedColumns=[],this.selectedCols=[],this.officesData=[],this.vip=[],this.counter=0,this.enableExtraRec=!1,this.officesListSelected={},this.offices=[],this.key="",this.currentOffices=[],this.tempOC="",this.isInOffice=!1,this.originalRecepients=[],this.isHaveChanges=!1,this.changedCity=!1,this.flag=!0}trackChanges(){this.composerService.cities.subscribe({next:t=>{t&&(this.currentCities=t)}}),this.composerService.validation.subscribe(t=>{this.v=t}),this.composerService.extraRec.subscribe(t=>{if(this.enableExtraRec=t,0==t)for(let n of this.recepients)n.recName2="";this.cdr.detectChanges()})}ngOnInit(){this.onCreate(),this.trackChanges(),this.pushNewRec(),this.originalRecepients=JSON.parse(JSON.stringify(this.recepients))}ngOnChanges(t){}onCreate(){this.setTableConfig(),this.getVipList(),this.recepients=this.dataShared.recepients,this.newReceipent={id:this.counter,addressDetails:null,address:null,cityCode:"",recName:"",recName2:"",officeCode:"",postalOffice:"",recVip:!1,senderResp:!1,telNo:"",vipNo:0,fees:0},this.counter++,this.composerService.isInOffice.subscribe(t=>{this.isInOffice=t})}getVipList(){this.vip=[],this.composerService.countryCode.subscribe(t=>{this.composerService.getChangeData(`VIP?code=${t}`).subscribe(n=>{this.vip=n.body.length>0?n.body:[]})})}setDraftData(t){let n=["recVip","senderResp"];if(t?.length>0){this.recepients=[];for(let s=0;s<t.length;s++)this.recepients.push(t[s]),delete this.recepients[s].genId,n.forEach(o=>{this.recepients[s][o]="0"!=this.recepients[s][o]&&null!=this.recepients[s][o]}),this.recepients[s].recVip?this.setVipData(parseInt(this.recepients[s].vipNo),s):(this.recepients[s].cityCode=this.currentCities?.find(r=>r.cityCode===t[s]?.cityCode),this.setOffices(this.recepients[s].cityCode,s,!0),this.recepients[s].officeCode=t[s]?.officeCode,this.recepients[s].address={keywordName:t[s]?.address})}this.dataShared.recepients=this.recepients,setTimeout(()=>{this.composerService._isEdited=!1,this.flag=!0},500)}ngDoCheck(){this.isHaveChanges||this.composerService.isFormEdited()||this.recepients.some((n,s)=>{const o=this.originalRecepients[s];return JSON.stringify(n)!==JSON.stringify(o)})&&(this.isHaveChanges=!0)}ngAfterViewInit(){}set selectedColumns(t){this._selectedColumns=this.cols.filter(n=>t.includes(n))}pushNewRec(){let t;t=Object.assign({},this.recepients[this.recepients.length-1]),t.recName=null,t.id=this.counter++,this.recepients.unshift(t),this.key=null,this.setOffices(t.cityCode,this.recepients.length-1),this.recepients[this.recepients.length-1].address="string"==typeof this.recepients[this.recepients.length-2]?.address?{keywordName:this.recepients[this.recepients.length-2]?.address}:this.recepients[this.recepients.length-2]?.address}openNew(){this.pushNewRec(),this.submitted=!1,this.recepientDialog=!0}deleteSelectedRecepients(){this.confirmationService.confirm({message:"Are you sure you want to delete the selected Recepients?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.recepients=this.recepients.filter(t=>!this.selectedRecepients?.includes(t)),this.selectedRecepients=[],this.messageService.add({severity:"success",summary:"Successful",detail:"Recepients Deleted",life:3e3})}})}deleteRecepient(t){this.recepients.splice(t,1)}hideDialog(){this.recepientDialog=!1,this.submitted=!1}saveRecepient(){this.submitted=!0}setOffices(t,n,s=!1){t==this.cityCode?this.changedCity=!1:(this.changedCity=!0,this.cityCode=t?.cityCode);let o=this.officesData.some(h=>h.cityCode==t),r=this.recepients[n].cityCode;s||(this.recepients[n].address=null);let d=this.officesData.findIndex(h=>h.index.includes(n));this.officesData[d]?.index.splice(this.officesData[d]?.index.indexOf(n),1),t&&!o?this.composerService.getChangeData(`getPostalOffices?cityCode=${t.cityCode}`).subscribe(h=>{this.officesData.push({cityCode:t.cityCode,index:[n],offices:h.body})}):this.officesData.find(f=>f.cityCode==r?.cityCode)?.index?.push(n)}checkCityCodeExist(){}changeVipMode(t,n){t||this.setVipData(null,n)}getVibObj(t){return this.vip.find(n=>n.personNo===t)}setVipData(t,n){let s=this.getVibObj(t);this.recepients[n].recVip&&t?(this.recepients[n].recName=s?.personNo?s?.personTitle+s?.personName:"",this.recepients[n].fees=s?.fees,this.recepients[n].cityCode=this.currentCities?.find(r=>r.cityCode===s?.cityCode),this.setOffices(this.recepients[n].cityCode,n),this.recepients[n].vipNo=s?.personNo,this.recepients[n].address={keywordName:s?.officialAddress},this.recepients[n].officeCode=s?.officeCode,s?.officeCode&&setTimeout(()=>{this.recepients[n].officeCode=s?.officeCode},0)):(this.recepients[n].address=null,this.recepients[n].addressDetails=null,this.recepients[n].recName=null,this.recepients[n].officeCode=null,this.recepients[n].cityCode=null,this.recepients[n].vipNo=0,this.recepients[n].fees=0)}filterItems(t,n){let s=this.recepients[n].cityCode.cityCode,o=t.query.toLowerCase();o.length<3?this.officesListKeyes=[]:this.getAddressesKeys(o,s||"")}getAddressesKeys(t,n){n&&this.composerService.getChangeData(`getOfficeByKeywords?word=${t}&code=${n}`).subscribe(s=>{this.orginalOfficeList=s.body,this.officesListKeyes=s.body})}filteroffices(t,n){let s=this.recepients[n]?.cityCode?.cityCode;this.orginalOfficeList=this.officesData?.filter(d=>d.cityCode==s),this.orginalOfficeList=this.orginalOfficeList[0]?.offices;let o=t?.officeCODE,r=this.orginalOfficeList?.find(d=>d.officeCode==o);this.recepients[n].officeCode=r?.officeCode?r?.officeCode:null}getCityOfficesDataByIndex(t){let n=this.officesData?.filter(s=>s?.index?.includes(t));return void 0!==n&&(this.currentOffices=n.filter(s=>s.index.length>0)[0]?.offices),this.currentOffices}encodeResponsibilityToBinary(t,n,s){this.recepients[t][n]=s?1:0}setTableConfig(){this.cols=se,this.selectedCols=this.cols.filter(t=>1==t.display),this._selectedColumns=this.selectedCols,this.globalFilterFields=this._selectedColumns.map(t=>t.field),this._selectedColumns=this.cols.filter(t=>1===t.display)}fieldEdited(){this.flag=!1,this.composerService._isEdited=!0,console.log("form is modified")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g),e.Y36(v.ez),e.Y36(v.YP),e.Y36(e.sBO),e.Y36(T),e.Y36(m.sK))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-recepients"]],inputs:{viewOverlay:"viewOverlay",selectedColumns:"selectedColumns"},features:[e.TTD],decls:9,vars:16,consts:[[1,"my-2"],[3,"multiple"],[3,"header","selected"],["dataKey","id",3,"value","rows","columns","globalFilterFields","selection","scrollable","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pFrozenColumn","",2,"text-align","center","z-index","99"],[1,"fa-solid","fa-plus",2,"color","green","font-weight","bolder","cursor","pointer","font-size","16px !important",3,"pTooltip","click"],[4,"ngIf","ngIfElse"],["anotherLang",""],["style","text-align: right",4,"ngFor","ngForOf"],[2,"text-align","right"],["style","text-align: left",4,"ngFor","ngForOf"],[2,"text-align","left"],["pFrozenColumn","",2,"z-index","99"],[1,"btn-delete-warn",3,"disabled","click"],[1,"fa-regular","fa-trash-can"],[4,"ngFor","ngForOf"],["class","form-check-input","type","checkbox","style","margin: 1rem;",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["class","form-check-input","type","checkbox","style","margin: 1rem;",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["optionLabel","cityName","placeholder","Select",3,"filter","appendTo","options","ngModel","style","showClear","ngModelChange",4,"ngIf"],["optionLabel","officeName","optionValue","officeCode","placeholder","Select",3,"filter","appendTo","options","ngModel","style","showClear","ngModelChange",4,"ngIf"],["style","max-height: 100px; min-height: 50px;","pInputTextarea","",3,"disabled","width","ngModel","value","class","ngModelChange",4,"ngIf"],["type","text","pInputText","","style","width: 100px;","class","p-inputtext-sm",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","style","width: 100px;","pInputText","","class","p-inputtext-sm",3,"disabled","ngModel","pKeyFilter","class","ngModelChange",4,"ngIf"],["type","checkbox",1,"form-check-input",2,"margin","1rem",3,"ngModel","ngModelChange"],["optionLabel","personName","optionValue","personNo","placeholder","Select vip",3,"ngClass","appendTo","options","ngModel","ngModelChange"],["placeholder","Select vip",3,"disabled","options","ngModelChange"],["type","checkbox",1,"form-check-input",2,"margin","1rem",3,"ngModel","ngModelOptions","ngModelChange"],["optionLabel","cityName","placeholder","Select",3,"filter","appendTo","options","ngModel","showClear","ngModelChange"],["optionLabel","officeName","optionValue","officeCode","placeholder","Select",3,"filter","appendTo","options","ngModel","showClear","ngModelChange"],["pInputTextarea","",2,"max-height","100px","min-height","50px",3,"disabled","ngModel","value","ngModelChange"],[1,"rad",2,"display","block"],["id","officeList","field","keywordName","appendTo","body",3,"disabled","suggestions","ngModel","completeMethod","onSelect","ngModelChange"],["type","text","pInputText","",1,"p-inputtext-sm",2,"width","100px",3,"ngModel","ngModelChange"],["type","text","pInputText","",1,"p-inputtext-sm",2,"width","100px",3,"disabled","ngModel","pKeyFilter","ngModelChange"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0)(1,"p-accordion",1)(2,"p-accordionTab",2),e.ALo(3,"translate"),e.TgZ(4,"p-table",3,4),e.NdJ("selectionChange",function(r){return s.selectedRecepients=r}),e.YNc(6,de,7,7,"ng-template",5),e.YNc(7,we,5,6,"ng-template",6),e.qZA()()(),e._UZ(8,"p-confirmDialog"),e.qZA()),2&n&&(e.Tol(s.viewOverlay?"":"disableAll"),e.xp6(1),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("header",e.lcZ(3,13,"composer.recepients.title"))("selected",!0),e.xp6(2),e.Q6J("value",s.recepients)("rows",10)("columns",s.selectedColumns)("globalFilterFields",s.globalFilterFields)("selection",s.selectedRecepients)("scrollable",!0),e.xp6(4),e.Akn(e.DdM(15,Oe)))},dependencies:[p.mk,p.sg,p.O5,l.Fj,l.Wl,l.JJ,l.On,S.Lt,v.jx,b.UQ,b.US,R.o,ie.Q,$.Fr,x.iA,x.on,F.u,I.g,oe.Qc,m.X$],styles:[".btn-delete-warn[_ngcontent-%COMP%]{border-radius:50%;height:3rem;color:#fff;background:#F59E0B;border:1px solid #F59E0B;width:3rem;padding:.75rem 0;justify-content:center;opacity:.8!important}.btn-delete-warn[_ngcontent-%COMP%]:hover{opacity:1!important}.not-allow-cursor[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6!important;pointer-events:none}.danger-border[_ngcontent-%COMP%]{border:1px solid red}.black-border[_ngcontent-%COMP%]{border:1px solid #ced4da}.rad[_ngcontent-%COMP%]{border-radius:8px}.headerAr[_ngcontent-%COMP%]{text-align:right}.headerEn[_ngcontent-%COMP%]{text-align:left}  #officeList>span>input{border:none;border-radius:9px}  .p-datatable .p-datatable-thead>tr>th{text-align:left;padding:0 13px;border:1px solid #dee2e6;border-width:0 0 1px 0;font-weight:700;color:#343a40;background:#f8f9fa;transition:box-shadow .2s}  .danger-border2>.p-dropdown{border:red solid 1px}  .p-datatable .p-datatable-tbody>tr>td{padding:3px}.form-check-input[type=checkbox][_ngcontent-%COMP%]{border-radius:50%;width:25px;height:25px;min-height:25px!important;border-color:#a5a5a5;cursor:pointer}  .recVip .p-dropdown-label{margin-top:5px}"]})}return i})(),Ne=(()=>{class i{constructor(t,n,s,o){this.composerService=t,this.fb=n,this.sectionData=s,this.ref=o,this.formFocusd=!1,this.ngUnsubscribe=new C.x,this.messageForm=this.sectionData.getMessageForm,this.subscriptions=[],this.disableFlags={sms:!1,deliveryNotic:!1,urgent:!1,decoration:!1,tempTypeCode:!1},this.decorationList=[{label:"\u0628\u062f\u0648\u0646 \u0645\u0632\u0631\u0643\u0634",value:0},{label:"\u0645\u0632\u0631\u0643\u0634",value:1},{label:"\u0645\u0632\u0631\u0643\u0634 \u0631\u062c\u0627\u0644 \u0623\u0639\u0645\u0627\u0644",value:2}]}ngOnChanges(t){}ngOnInit(){let t=this.composerService.validation.subscribe(n=>{this.validationMsg=n.msg});this.subscriptions.push(t),this.composerService.adminCheck.subscribe(n=>{this.setEmptyMsg(n)}),this.messageForm.controls.template.valueChanges.subscribe(n=>{this.onChangeTemplate(n)}),this.getFlags(),this.trackChanging()}handleFocus(t){this.formFocusd&&(this.formFocusd=!0)}trackChanging(){setTimeout(()=>{this.messageForm.markAsPristine();let t=this.messageForm.valueChanges.pipe((0,E.x)(),(0,V.R)(this.ngUnsubscribe)).subscribe(()=>{!this.messageForm.pristine&&this.formFocusd&&(console.log("form is modified"),this.composerService._isEdited=!0,t.unsubscribe())})},1e3)}setDraftData(t){this.draftData=t,this.patchFormControl("template",parseInt(t?.template)),this.patchFormControl("tempTypeCode",t?.tempTypeCode),this.patchFormControl("tempCode",t?.tempCode),this.patchFormControl("message",t?.message),this.patchFormControl("decoration",parseInt(t?.decoration)),this.patchFormControl("sms",1==t?.sms),this.patchFormControl("deliveryNotic",1==t?.deliveryNotic),this.patchFormControl("urgent",1==t?.urgent),this.onChangeTempType(t?.tempTypeCode,t?.tempCode),0==parseInt(t?.template)&&"0"==t?.tempTypeCode&&0==parseInt(t?.tempCode)&&this.patchFormControl("message",t?.message),setTimeout(()=>{this.composerService._isEdited=this.formFocusd=!1},500)}getFlags(){let t=this.composerService.triffPlan.subscribe({next:n=>{if(this.tarrifObject=n,this.draftData||this.resetForm(),n)for(let s in n)this.convertFlagsToBoolean(s,n[s])},error:n=>{},complete:()=>{}});this.subscriptions.push(t)}resetForm(){this.messageForm.patchValue({template:0,tempTypeCode:"0",tempCode:null,decoration:0,deliveryNotic:0,urgent:0,sms:0}),this.onChangeTempType("0",!1,!1),this.enableFormControl("message")}convertFlagsToBoolean(t,n){(0==n||null==n)&&(this.disableFlags[t]=!0,this.disableFormControl(t),"tempTypeCode"==t&&this.disableFormControl("template")),1==n&&(this.disableFlags[t]=!1,this.enableFormControl(t),"tempTypeCode"==t&&this.enableFormControl("template")),this.draftData||this.disableFormControl("tempTypeCode")}setEmptyMsg(t){this.messageForm.patchValue({template:0,tempTypeCode:"0",tempCode:null,decoration:0,deliveryNotic:0,urgent:0,sms:0}),this.onChangeTempType("0",!1,!1),t?(this.messageForm.disable(),this.enableFormControl("message")):(this.messageForm.enable(),this.enableFormControl("sms"),this.enableFormControl("deliveryNotic"),this.enableFormControl("urgent"),this.enableFormControl("decoration"),this.disableFormControl("tempTypeCode"),this.disableFormControl("tempCode"))}setTemplateList(t){"0"==t?this.templeteList=[]:this.tempeleteTypeList?.map(n=>{n.tempTypeCode==t&&(this.templeteList=n.template_Entity)})}setMessage(t){let n=this.templeteList.find(s=>s.tempCode===t);this.patchFormControl("message",n?.tempSubject||this.messageForm.controls.message.value)}convertToBinary(t){t=t?1:0}onChangeTemplate(t){t?t&&(this.patchFormControl("decoration",0),this.disableFormControl("decoration"),this.draftData||this.patchFormControl("message",""),this.disableFormControl("message"),this.enableFormControl("tempTypeCode"),this.composerService.setValidation("msg",!1),this.composerService.extrasender.next(!0),this.composerService.extraRec.next(!0)):((0==this.tarrifObject?.decoration||1==this.draftData?.template)&&this.disableFormControl("decoration"),1==this.tarrifObject?.decoration&&this.enableFormControl("decoration"),this.enableFormControl("message"),this.patchFormControl("tempTypeCode","0"),this.patchFormControl("tempCode",null),this.disableFormControl("tempCode"),this.disableFormControl("tempTypeCode"),this.composerService.extrasender.next(!1),this.composerService.extraRec.next(!1),this.templeteList=[])}onChangeTempType(t,n=null,s=!0){t==this.prevTempTypeCode&&s||(this.prevTempTypeCode=t,this.setTemplateList(t),null==n&&this.patchFormControl("decoration",0),"0"!=t&&null!=t&&null!=t?(this.enableFormControl("tempCode"),null!=n&&parseInt(n)>0&&this.setMessage(n),this.composerService.extrasender.next(!0),this.composerService.extraRec.next(!0)):(this.patchFormControl("message",""),this.disableFormControl("tempCode"),this.disableFormControl("tempTypeCode"),this.composerService.extrasender.next(!1),this.composerService.extraRec.next(!1),this.templeteList=[]))}disableFormControl(t){this.messageForm.controls[t].disable()}enableFormControl(t){this.messageForm.controls[t].enable()}patchFormControl(t,n){this.messageForm.controls[t].patchValue(n)}ngOnDestroy(){for(let t of this.subscriptions)t.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g),e.Y36(l.qu),e.Y36(T),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-message-details"]],inputs:{tempeleteTypeList:"tempeleteTypeList"},features:[e.TTD],decls:51,vars:35,consts:[[1,"my-2"],[3,"multiple"],[3,"header","selected"],[2,"justify-content","space-between","padding","8px 15px",3,"formGroup","click"],[1,"col-lg-6","message-contents"],[2,"display","flex","gap","0 1rem"],[2,"display","flex","align-items","center"],[1,"text-danger"],["type","checkbox","formControlName","template","id","template",1,"form-check-input",3,"ngModelChange"],["for","tempTypeCode",2,"min-width","90px","margin-bottom","3px"],["optionLabel","tempTypeName","optionValue","tempTypeCode","formControlName","tempTypeCode","name","tempTypeCode","placeholder","Select",1,"temp-list",3,"options","ngModelChange"],[2,"min-width","90px","margin-bottom","3px"],["optionLabel","tempName","optionValue","tempCode","name","templeteList","formControlName","tempCode",1,"temp-list",3,"options","ngModelChange"],["optionLabel","label","optionValue","value","name","decoration","formControlName","decoration",1,"temp-list",3,"options"],["for","deliveryNotic"],["type","checkbox","formControlName","deliveryNotic","id","deliveryNotic",1,"form-check-input",3,"ngModelChange"],["for","urgent"],["type","checkbox","formControlName","urgent","id","urgent",1,"form-check-input",3,"ngModelChange"],["for","sms"],["type","checkbox","formControlName","sms","id","sms",1,"form-check-input",3,"ngModelChange"],["for","Message"],["formControlName","message","inputId","message","rows","3","pInputTextarea","",2,"width","100%"],["msgVal",""]],template:function(n,s){if(1&n&&(e.TgZ(0,"div",0)(1,"p-accordion",1)(2,"p-accordionTab",2),e.ALo(3,"translate"),e.TgZ(4,"form",3),e.NdJ("click",function(r){return s.handleFocus(r)}),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"label"),e._uU(9),e.ALo(10,"translate"),e.TgZ(11,"span",7),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"input",8),e.NdJ("ngModelChange",function(r){return s.convertToBinary(r)}),e.qZA()(),e.TgZ(14,"div")(15,"label",9),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"p-dropdown",10),e.NdJ("ngModelChange",function(r){return s.onChangeTempType(r)}),e.qZA()(),e.TgZ(19,"div")(20,"label",11),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"p-dropdown",12),e.NdJ("ngModelChange",function(r){return s.setMessage(r)}),e.qZA()()(),e.TgZ(24,"div",5)(25,"div")(26,"label",11),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._UZ(29,"p-dropdown",13),e.qZA(),e.TgZ(30,"div",6)(31,"label",14),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"input",15),e.NdJ("ngModelChange",function(r){return s.convertToBinary(r)}),e.qZA()(),e.TgZ(35,"div",6)(36,"label",16),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"input",17),e.NdJ("ngModelChange",function(r){return s.convertToBinary(r)}),e.qZA()(),e.TgZ(40,"div",6)(41,"label",18),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",19),e.NdJ("ngModelChange",function(r){return s.convertToBinary(r)}),e.qZA()()(),e.TgZ(45,"div")(46,"label",20),e._uU(47),e.ALo(48,"translate"),e.qZA(),e._UZ(49,"textarea",21,22),e.qZA()()()()()()),2&n){const o=e.MAs(50);e.xp6(1),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("header",e.lcZ(3,17,"composer.messageDetails.title"))("selected",!0),e.xp6(2),e.Q6J("formGroup",s.messageForm),e.xp6(5),e.hij("",e.lcZ(10,19,"composer.messageDetails.template"),":"),e.xp6(7),e.hij("",e.lcZ(17,21,"composer.messageDetails.templateType"),":"),e.xp6(2),e.Q6J("options",s.tempeleteTypeList),e.xp6(3),e.hij("",e.lcZ(22,23,"composer.messageDetails.msgType"),":"),e.xp6(2),e.Q6J("options",s.templeteList),e.xp6(4),e.hij("",e.lcZ(28,25,"composer.messageDetails.decoration"),":"),e.xp6(2),e.Q6J("options",s.decorationList),e.xp6(3),e.hij("",e.lcZ(33,27,"composer.messageDetails.deliveryNotice"),":"),e.xp6(5),e.hij("",e.lcZ(38,29,"composer.messageDetails.paidReply"),":"),e.xp6(5),e.hij("",e.lcZ(43,31,"composer.messageDetails.sms"),":"),e.xp6(5),e.hij("",e.lcZ(48,33,"composer.messageDetails.title")," *"),e.xp6(2),e.Akn(s.validationMsg&&""==o.value?"border:1px solid red;":"")}},dependencies:[l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.sg,l.u,S.Lt,b.UQ,b.US,I.g,m.X$],styles:[".temp-list[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:220px}.danger-border[_ngcontent-%COMP%]{border:1px solid red}.hide[_ngcontent-%COMP%]{display:none}  .p-accordion .p-accordion-content{font-weight:500}.custom-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,max(140px,10% - 1.5rem));gap:.5rem 1rem}.text-area-container[_ngcontent-%COMP%]{grid-column:span 2}.custom-grid[_ngcontent-%COMP%]   .check-box-container[_ngcontent-%COMP%]{display:flex;align-items:center}.form-check-input[type=checkbox][_ngcontent-%COMP%]{border-radius:50%;width:25px;height:25px;min-height:25px!important;border-color:#a5a5a5;margin-left:.5rem;margin:.5rem;cursor:pointer}.row-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.dropdown-container[_ngcontent-%COMP%]{display:flex;align-items:center}"]})}return i})();function Fe(i,a){if(1&i&&(e.TgZ(0,"th",13),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.headerAr," ")}}function Se(i,a){if(1&i&&(e.ynx(0),e.YNc(1,Fe,2,1,"th",12),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function Ie(i,a){if(1&i&&(e.TgZ(0,"th",15),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.headerEn," ")}}function qe(i,a){if(1&i&&e.YNc(0,Ie,2,1,"th",14),2&i){const t=e.oxw().$implicit;e.Q6J("ngForOf",t)}}function Ue(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr",7)(1,"th",8)(2,"i",9),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.pushNewSender())}),e.ALo(3,"translate"),e.qZA()(),e.YNc(4,Se,2,1,"ng-container",10),e.YNc(5,qe,1,1,"ng-template",null,11,e.W1O),e.qZA()}if(2&i){const t=e.MAs(6),n=e.oxw();e.xp6(2),e.Q6J("pTooltip",e.lcZ(3,3,"composer.senders.addSender")),e.xp6(2),e.Q6J("ngIf","ar"==n.translateService.currentLang)("ngIfElse",t)}}function Le(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"textarea",23),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.Tol(!s.v.senName||"senderName"!=t.field||""!=n[t.field]&&null!=n[t.field]&&null!=n[t.field]?"":"danger-border"),e.Q6J("disabled","senderName2"==t.field&&!s.enableExtraSender)("ngModel",n[t.field])}}function Re(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",24),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.Tol(s.v.email&&"email"==t.field?"danger-border":""),e.Q6J("ngModel",n[t.field])}}function Pe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"input",25),e.NdJ("ngModelChange",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.flag&&s.fieldEdited())})("ngModelChange",function(s){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw().$implicit;return e.KtG(r[o.field]=s)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,s=e.oxw();e.Tol(s.v.nationalId&&"nationalId"==t.field||s.v.mobileNo&&"mobileNo"==t.field?"danger-border":""),e.Q6J("ngModel",n[t.field])("pKeyFilter","number"==t.type?"int":"num")}}function Je(i,a){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,Le,1,4,"textarea",20),e.YNc(2,Re,1,3,"input",21),e.YNc(3,Pe,1,4,"input",22),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf","textarea"==t.type),e.xp6(1),e.Q6J("ngIf","text"==t.type),e.xp6(1),e.Q6J("ngIf","number"==t.type&&"id"!=t.field)}}function je(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",16)(2,"button",17),e.NdJ("click",function(){const o=e.CHM(t).rowIndex,r=e.oxw();return e.KtG(r.deleteSender(o))}),e._UZ(3,"i",18),e.qZA()(),e.YNc(4,Je,4,3,"td",19),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Tol(t.senders.length<2?"not-allow-cursor":""),e.Q6J("disabled",1==t.senders.length),e.xp6(2),e.Q6J("ngForOf",t.cols)}}let Ee=(()=>{class i{constructor(t,n,s,o){this.composerService=t,this.translateService=n,this.dataShared=s,this.changeDetectorRef=o,this.senders=[],this.selectedSenders=[],this.submitted=!1,this.cols=[],this._selectedColumns=[],this.selectedCity="",this.selectedCols=[],this.globalFilterFields=[],this.enableExtraSender=!1,this.viewOverlay=!1,this.isHaveChanges=!1,this.counter=0,this.flag=!0,this.cols=[{field:"senderName",headerEn:"Sender Name",headerAr:"\u0627\u0633\u0645 \u0627\u0644\u0631\u0627\u0633\u0644",display:1,type:"textarea",value:""},{field:"senderName2",headerEn:"Extra Sender",headerAr:"\u0627\u0644\u0631\u0627\u0633\u0644 \u0627\u0644\u0627\u0636\u0627\u0641\u064a",display:1,type:"textarea",value:""},{field:"address",headerEn:"Address",headerAr:"\u0627\u0644\u0639\u0646\u0648\u0627\u0646",display:1,type:"textarea",value:""},{field:"nationalId",headerEn:"National Id",headerAr:"\u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629",display:1,type:"number",value:""},{field:"mobileNo",headerEn:"Mobile No",headerAr:"\u0631\u0642\u0645 \u0627\u0644\u0645\u0648\u0628\u0627\u064a\u0644",display:1,type:"number",value:""},{field:"email",headerEn:"Email",headerAr:"\u0627\u0644\u0627\u064a\u0645\u064a\u0644",display:1,type:"text",value:""}],this.selectedCols=this.cols.filter(r=>1==r.display),this._selectedColumns=this.selectedCols,this.globalFilterFields=this._selectedColumns.map(r=>r.field),this.newSender={id:this.counter,senderName:"",senderName2:"",address:"",nationalId:"",mobileNo:"",email:""},this.counter++}printTable(){}ngDoCheck(){this.isHaveChanges||this.composerService.isFormEdited()||this.senders.some((n,s)=>{const o=this.originalSenders[s];return JSON.stringify(n)!==JSON.stringify(o)})&&(this.composerService._isEdited=!0,console.log("form is modified"),this.isHaveChanges=!0)}getClass(t){}ngOnInit(){this.senders=this.dataShared.senders,this.pushNewSender(),this.composerService.validation.subscribe(t=>{this.v=t}),this.composerService.extrasender.subscribe(t=>{if(this.enableExtraSender=t,0==t)for(let n of this.senders)n.senderName2=""}),this.originalSenders=JSON.parse(JSON.stringify(this.senders))}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}removesender(t){}get selectedColumns(){return this._selectedColumns}set selectedColumns(t){this.selectedColumns=t,this._selectedColumns=this.selectedColumns,this.globalFilterFields=this._selectedColumns.map(n=>n.field)}pushNewSender(){let t=Object.assign({});t.senderName=null,t.id=this.counter++,this.senders.unshift(t)}deleteSender(t){this.senders.splice(t,1),this.removesender(t),this.counter--}setDraftData(t){this.senders=t,this.dataShared.senders=this.senders,setTimeout(()=>{this.composerService._isEdited=!1,this.flag=!0},500)}hideDialog(){this.submitted=!1}saveSender(){this.submitted=!0}fieldEdited(){this.flag=!1,this.composerService._isEdited=!0,console.log("form is modified")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g),e.Y36(m.sK),e.Y36(T),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-senders"]],inputs:{viewOverlay:"viewOverlay",selectedColumns:"selectedColumns"},decls:9,vars:13,consts:[[1,"my-2"],[3,"multiple"],[3,"header","selected"],["dataKey","id",3,"value","rows","columns","globalFilterFields","selection","scrollable","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],[2,"height","36.53px"],["pFrozenColumn","",2,"text-align","center","z-index","99","padding","10px auto"],[1,"fa-solid","fa-plus",2,"color","green","font-weight","bolder","cursor","pointer","font-size","16px !important",3,"pTooltip","click"],[4,"ngIf","ngIfElse"],["anotherLang",""],["style","text-align: right",4,"ngFor","ngForOf"],[2,"text-align","right"],["style","text-align: left",4,"ngFor","ngForOf"],[2,"text-align","left"],["pFrozenColumn","",2,"z-index","99"],[1,"btn-delete-warn",3,"disabled","click"],[1,"fa-regular","fa-trash-can"],[4,"ngFor","ngForOf"],["style","max-height: 100px; min-height: 50px; width: 200px","pInputTextarea","",3,"disabled","ngModel","class","ngModelChange",4,"ngIf"],["type","text","pInputText","","class","p-inputtext-sm",3,"ngModel","class","ngModelChange",4,"ngIf"],["type","text","pInputText","","class","p-inputtext-sm",3,"ngModel","pKeyFilter","class","ngModelChange",4,"ngIf"],["pInputTextarea","",2,"max-height","100px","min-height","50px","width","200px",3,"disabled","ngModel","ngModelChange"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModel","pKeyFilter","ngModelChange"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0)(1,"p-accordion",1)(2,"p-accordionTab",2),e.ALo(3,"translate"),e.TgZ(4,"p-table",3,4),e.NdJ("selectionChange",function(r){return s.selectedSenders=r}),e.YNc(6,Ue,7,5,"ng-template",5),e.ynx(7),e.YNc(8,je,5,4,"ng-template",6),e.BQk(),e.qZA()()()()),2&n&&(e.Tol(s.viewOverlay?"":"disableAll"),e.xp6(1),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("header",e.lcZ(3,11,"composer.senders.title"))("selected",!0),e.xp6(2),e.Q6J("value",s.senders)("rows",10)("columns",s.selectedColumns)("globalFilterFields",s.globalFilterFields)("selection",s.selectedSenders)("scrollable",!0))},dependencies:[p.sg,p.O5,l.Fj,l.JJ,l.On,v.jx,b.UQ,b.US,R.o,$.Fr,x.iA,x.on,F.u,I.g,m.X$],styles:[".btn-delete-warn[_ngcontent-%COMP%]{border-radius:50%;height:3rem;color:#fff;background:#F59E0B;border:1px solid #F59E0B;width:3rem;padding:.75rem 0;justify-content:center;opacity:.8!important}.btn-delete-warn[_ngcontent-%COMP%]:hover{opacity:1!important}.not-allow-cursor[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6!important;pointer-events:none}.danger-border[_ngcontent-%COMP%]{border:1px solid red}  .p-datatable .p-datatable-thead>tr>th{text-align:left;padding:0 13px;border:1px solid #dee2e6;border-width:0 0 1px 0;font-weight:700;color:#343a40;background:#f8f9fa;transition:box-shadow .2s}  .p-datatable .p-datatable-tbody>tr>td{padding:3px}"]})}return i})(),Ve=(()=>{class i{constructor(t){this.http=t}getUsersByOfficeCode(t){return this.http.get(`${A.D.apiURL}/Composer/getUsersName?office=${t}`)}getDailyReports(t){return this.http.post(`${A.D.apiURL}/Composer/DailyReport`,t)}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(Z.eN))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Q=c(6864);const ke=["dailyReportModal"];function $e(i,a){1&i&&e.GkF(0)}function Be(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"form",5),e.NdJ("ngSubmit",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.getDailyReport())}),e.TgZ(2,"div",6)(3,"div",7)(4,"label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"p-calendar",8),e.qZA(),e.TgZ(8,"div",7)(9,"label"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e._UZ(12,"p-calendar",9),e.qZA(),e.TgZ(13,"div",7)(14,"label"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"p-dropdown",10),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.dailyReportForm),e.xp6(4),e.hij(" ",e.lcZ(6,9,"composer.header.dailyReport.dateFrom")," "),e.xp6(2),e.Q6J("showIcon",!0),e.xp6(3),e.hij(" ",e.lcZ(11,11,"composer.header.dailyReport.dateTo")," "),e.xp6(2),e.Q6J("showIcon",!0),e.xp6(3),e.hij(" ",e.lcZ(16,13,"composer.header.dailyReport.user")," "),e.xp6(2),e.Q6J("baseZIndex",9e16)("options",t.users)("autoDisplayFirst",!0)}}let Qe=(()=>{class i{constructor(t,n,s,o,r){this.toastService=t,this.printService=n,this.translate=s,this.dailyApis=o,this.permissionsService=r,this.newDate=new Date,this.users=[],this.dailyReportForm=new l.cw({dateFrom:new l.NI("",{validators:[l.kI.required]}),dateTo:new l.NI("",{validators:[l.kI.required]}),userName:new l.NI("",l.kI.required)})}ngOnInit(){}actionOnModal(t){this.dailyReportModal?.clickOnButton(t)}getDailyReport(){if(this.dailyReportForm.invalid)return void this.toastService.showError("Enter Valid Data");let t=new p.uU("en-US").transform(this.dailyReportForm.controls.dateFrom.value,"dd/MM/yyyy")?.toString(),n=new p.uU("en-US").transform(this.dailyReportForm.controls.dateTo.value,"dd/MM/yyyy")?.toString();this.dailyApis.getDailyReports({dateFrom:t,dateTo:n,userName:this.dailyReportForm.controls.userName.value}).subscribe({next:o=>{let r=o.body.dailyRepeortResponses?.length||0;o&&r>0?this.printDailyReport(o.body):0==r&&this.toastService.showWarning("No Data Found")},error:o=>{this.toastService.showError("Failed Fetching Report")},complete:()=>{}})}printDailyReport(t){let n;n=new p.uU("en-US").transform(this.newDate,"hh:mm:ss a dd-MM-yyyy")?.toString();let s=t.dailyRepeortResponses,o=s.length/30,r=0,d=[];for(let u=0;u<o;u++)d.push({pageNumber:u+1,pageContent:s.slice(r,r+30)}),r+=30;let h="",f=1;for(let u=0;u<d.length;u++){let w="",J="";u==d.length-1?w+=`<h2\n        style="font-size: 20px !important; direction: rtl;"\n        >\n        \u0627\u0644\u0645\u0628\u0644\u063a \u0627\u0644\u0643\u0644\u0649 : ${t.totalCost} \u0642\u0631\u0634\u0627\n        </h2>`:w="",0==u?J+='<div style="display: flex; justify-content: center">\n        <h1 style="font-size: 22px !important">\n          \u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u064a\u0648\u0645\u064a (BSI)\n        </h1>\n      </div>':J="";let H="";for(let j=0;j<d[u].pageContent.length;j++){let D=d[u].pageContent[j];H+=`<tr>\n        <td style="text-align: center">\n          ${D.office}\n        </td>\n        <td style="text-align: center">\n          ${D.tghCode}\n        </td>\n        <td style="text-align: center">\n          ${D.tghCost}\n        </td>\n        <td style="text-align: center">\n          ${D.sendDate}\n        </td>\n        <td style="text-align: center">\n          ${D.tghId}\n        </td>\n        <td style="text-align: center">\n          ${D.userCode}\n        </td>\n        <td style="text-align: center">\n          ${f}\n        </td>\n      </tr>`,f++}h+=`\n      <div\n      style="\n        margin: 20px 30px;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n        height:940px;\n      "\n    >\n      <div style="margin-bottom: 20px">\n        <div>\n          <img src="assets/images/CustomerLogo.jpg" />\n        </div>\n        ${J}\n      </div>\n      <table style="margin-bottom: 20px;">\n        <tr style="border-bottom: 1px solid;margin-bottom:10px">\n          <th style="text-align: center">\u0627\u0644\u0645\u0643\u062a\u0628</th>\n          <th>\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0623\u0635\u0644\u064a</th>\n          <th>\u0627\u0644\u062a\u0643\u0644\u0641\u0629</th>\n          <th>\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0627\u0631\u0633\u0627\u0644</th>\n          <th>\u0631\u0642\u0645 \u0627\u0644\u0628\u0631\u0642\u064a\u0629</th>\n          <th>\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645</th>\n          <th>\u0645</th>\n        </tr>\n        ${H}\n      </table>\n      ${w}\n      <div\n        class="footer"\n        style="\n          display: flex;\n          justify-content: space-around;\n          margin-right: 100px;\n          font-size: 15px !important;\n        "\n      >\n        <h3 style="font-size: 15px !important">\n          <span style="margin: 0 10px; font-size: 15px !important"\n            >Sunday, 11 June, 2023 12:07:46</span\n          >\n          \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0637\u0628\u0627\u0639\u0629\n        </h3>\n        <h3 style="font-size: 15px !important">\n          Page ${u+1} / ${d.length}\n        </h3>\n      </div>\n    </div>\n      `}try{this.printService.performPrint(h)}catch(u){console.error("An error occurred while printing:",u)}}resetDailyReportModal(){this.dailyReportForm.reset()}getUsers(){let t=localStorage.getItem("username")||"",n=localStorage.getItem("office")||"";this.permissionsService.havePermissions(["TghDailyReportDesktop.ViewAll"])[0]?n&&this.dailyApis.getUsersByOfficeCode(n).subscribe(s=>{this.users=s.body.map(o=>({userName:o}))}):this.users=[{userName:t}],this.actionOnModal("open")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(M.k),e.Y36(U),e.Y36(m.sK),e.Y36(Ve),e.Y36(N.q))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-daily-report"]],viewQuery:function(n,s){if(1&n&&e.Gf(ke,5),2&n){let o;e.iGM(o=e.CRH())&&(s.dailyReportModal=o.first)}},decls:5,vars:8,consts:[[3,"size","modal_name","action_name","cancel_name","header_name","disabled","showFooter","action_canceled","onAction"],["dailyReportModal",""],[4,"ngTemplateOutlet"],["myComponent",""],[1,"form-group-outer-container"],[3,"formGroup","ngSubmit"],[1,"form-group-inner-container"],[1,"col-lg-3","col-md-5","col-sm-12"],["type","date","dateFormat","dd.mm.yy","formControlName","dateFrom","appendTo","body",3,"showIcon"],["type","date","dateFormat","dd.mm.yy","formControlName","dateTo","appendTo","body",3,"showIcon"],["appendTo","body","optionLabel","userName","optionValue","userName","formControlName","userName","placeholder","Select User",1,"temp-list",3,"baseZIndex","options","autoDisplayFirst"]],template:function(n,s){if(1&n&&(e.TgZ(0,"mts-modal",0,1),e.NdJ("action_canceled",function(){return s.resetDailyReportModal()})("onAction",function(){return s.getDailyReport()}),e.YNc(2,$e,1,0,"ng-container",2),e.qZA(),e.YNc(3,Be,18,15,"ng-template",null,3,e.W1O)),2&n){const o=e.MAs(4);e.Q6J("size","modal-xl")("modal_name","dailyReportModal")("action_name",s.translate.instant("composer.header.dailyReport.search"))("cancel_name",s.translate.instant("composer.header.dailyReport.close"))("header_name",s.translate.instant("composer.header.dailyReport.title"))("disabled",s.dailyReportForm.invalid)("showFooter",!0),e.xp6(2),e.Q6J("ngTemplateOutlet",o)}},dependencies:[p.tP,l._Y,l.JJ,l.JL,l.sg,l.u,S.Lt,k.f,Q.z,m.X$],styles:[".form-group-inner-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem}.form-group-inner-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}return i})();var Ge=c(852);function He(i,a){1&i&&(e.TgZ(0,"tr")(1,"th"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"th"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"th"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"th"),e._uU(35),e.ALo(36,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,12,"composer.header.calculateCost.recepient")," "),e.xp6(3),e.Oqu(e.lcZ(6,14,"composer.header.calculateCost.address")),e.xp6(3),e.hij(" ",e.lcZ(9,16,"composer.header.calculateCost.costOfExtraName")," "),e.xp6(3),e.hij(" ",e.lcZ(12,18,"composer.header.calculateCost.numberOfExtras")," "),e.xp6(3),e.hij(" ",e.lcZ(15,20,"composer.header.calculateCost.wordCount")," "),e.xp6(3),e.hij(" ",e.lcZ(18,22,"composer.header.calculateCost.numberOfWords")," "),e.xp6(3),e.hij(" ",e.lcZ(21,24,"composer.header.calculateCost.postalOfficePrice")," "),e.xp6(3),e.hij(" ",e.lcZ(24,26,"composer.header.calculateCost.salesTax")," "),e.xp6(3),e.Oqu(e.lcZ(27,28,"composer.header.calculateCost.various")),e.xp6(3),e.Oqu(e.lcZ(30,30,"composer.header.calculateCost.vipCost")),e.xp6(3),e.Oqu(e.lcZ(33,32,"composer.header.calculateCost.msgCost")),e.xp6(3),e.hij(" ",e.lcZ(36,34,"composer.header.calculateCost.msgCostByFees")," "))}function Ye(i,a){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.qZA(),e.TgZ(25,"td"),e._uU(26),e.qZA()()),2&i){const t=a.$implicit;e.xp6(2),e.Oqu(null==t?null:t.recName),e.xp6(2),e.Oqu(null==t?null:t.address),e.xp6(2),e.Oqu(null==t?null:t.costOfExtraName),e.xp6(2),e.Oqu(null==t?null:t.numOfExtra),e.xp6(2),e.Oqu(null==t?null:t.numberOfWords),e.xp6(2),e.Oqu(null==t?null:t.wordCount),e.xp6(2),e.Oqu(null==t?null:t.noOfWords),e.xp6(2),e.Oqu(null==t?null:t.postalOfficePrice),e.xp6(2),e.Oqu(null==t?null:t.salesTax),e.xp6(2),e.Oqu(null==t?null:t.various),e.xp6(2),e.Oqu(null==t?null:t.vipPrice),e.xp6(2),e.Oqu(null==t?null:t.messageCost),e.xp6(2),e.Oqu(null==t?null:t.messageCostByFees)}}const Ke=function(i){return{direction:i}},ze=function(){return{"min-width":"50rem"}};let We=(()=>{class i{constructor(t,n,s,o,r,d){this.sectionData=t,this.sharedService=n,this.printService=s,this.toastService=o,this.composerService=r,this.sectionVariables=d,this.costObject={},this.printCostObj={}}ngOnInit(){}calculateCost(){this.costObject={callerName:this.sectionData.getTghDetailsForm.controls.callerName.value,planCode:this.sectionData.getTghDetailsForm.controls.planCode.value,senders:JSON.parse(JSON.stringify(this.sectionData.senders)),recepients:JSON.parse(JSON.stringify(this.sectionData.recepients)),template:this.sectionData.getMessageForm.controls.template.value?1:0,delivery:this.sectionData.getMessageForm.controls.deliveryNotic.value?1:0,decoration:this.sectionData.getMessageForm.controls.decoration.value,message:this.sectionData.getMessageForm.controls.message.value,urgent:this.sectionData.getMessageForm.controls.urgent.value?1:0,sms:this.sectionData.getMessageForm.controls.sms.value?1:0,admin:this.sectionData.getTghDetailsForm.controls.admin.value?1:0},this.sharedService.removeIds(this.costObject.recepients),this.sharedService.removeIds(this.costObject.senders),this.sectionVariables.costObject=this.costObject,this.sharedService.removeValidations(["telNo","mobileNo","nationalId","email"],0),this.sharedService.checkRequiredValidations(this.costObject)?this.sharedService.isValidFields(this.costObject)?(this.sharedService.handleRecepients(this.costObject.recepients),this.getCost(),this.sharedService.removeValidations(["telNo","mobileNo","nationalId","email"],0)):(this.toastService.showError("Incorrect Values"),this.sharedService.removeValidations(["telNo","mobileNo","nationalId","email"],1e4)):(this.toastService.showError("Enter Valid Data"),this.sharedService.removeValidations(this.sectionVariables.requiredValidations,2e4))}getCost(){console.log("calc cost"),this.printCostObj=JSON.parse(JSON.stringify(this.costObject)),this.composerService.post("calculateMsgCost",this.costObject).subscribe({next:t=>{this.sectionVariables.costDialogVisible=!0,this.costDialogVisible=!0,this.sectionVariables.costObject=t.body,this.costObject=t.body,this.sectionVariables.disableTableCost=!1,this.sectionVariables.costCalcDailog=!0},error:t=>{this.toastService.showError("Failed Calculate Message Cost")},complete:()=>{}}),this.costObject=[],this.costDialogVisible=!1}getDir(){this.sharedService.getDir()}getPrintData(){this.printService.getPrintData(this.printCostObj)}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(T),e.Y36(q),e.Y36(U),e.Y36(M.k),e.Y36(g),e.Y36(L))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-calculate-cost"]],decls:91,vars:64,consts:[[1,"fa-regular","fa-calculator",3,"pTooltip","click"],[3,"visible","ngStyle","visibleChange"],[2,"font-weight","bolder"],[1,"row"],[1,"col-lg-6","cost-popup"],[3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[2,"display","flex","justify-content","flex-end","margin-top","25px"],[1,"btn","btn-secondary",3,"click"]],template:function(n,s){1&n&&(e.TgZ(0,"i",0),e.NdJ("click",function(){return s.calculateCost()}),e.ALo(1,"translate"),e.qZA(),e.TgZ(2,"p-dialog",1),e.NdJ("visibleChange",function(r){return s.costDialogVisible=r}),e.TgZ(3,"h4",2),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"hr"),e.TgZ(7,"div")(8,"div",3)(9,"div",4),e._UZ(10,"span"),e.TgZ(11,"p")(12,"span"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"span"),e._uU(16),e.qZA()(),e.TgZ(17,"p")(18,"span"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"span"),e._uU(22),e.qZA()(),e.TgZ(23,"p")(24,"span"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"span"),e._uU(28),e.qZA()(),e.TgZ(29,"p")(30,"span"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"span"),e._uU(34),e.qZA()(),e.TgZ(35,"p")(36,"span"),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"span"),e._uU(40),e.qZA()(),e.TgZ(41,"p")(42,"span"),e._uU(43),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"span"),e._uU(46),e.qZA()()(),e.TgZ(47,"div",4)(48,"p")(49,"span"),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.TgZ(52,"span"),e._uU(53),e.qZA()(),e.TgZ(54,"p")(55,"span"),e._uU(56),e.ALo(57,"translate"),e.qZA(),e.TgZ(58,"span"),e._uU(59),e.qZA()(),e.TgZ(60,"p")(61,"span"),e._uU(62),e.ALo(63,"translate"),e.qZA(),e._uU(64),e._UZ(65,"span"),e.qZA(),e.TgZ(66,"p")(67,"span"),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"span"),e._uU(71),e.qZA()(),e.TgZ(72,"p")(73,"span"),e._uU(74),e.ALo(75,"translate"),e.qZA(),e.TgZ(76,"span"),e._uU(77),e.qZA()(),e.TgZ(78,"p")(79,"span"),e._uU(80),e.ALo(81,"translate"),e.qZA(),e.TgZ(82,"span"),e._uU(83),e.qZA()()()(),e.TgZ(84,"p-table",5),e.YNc(85,He,37,36,"ng-template",6),e.YNc(86,Ye,27,13,"ng-template",7),e.qZA()(),e.TgZ(87,"div",8)(88,"button",9),e.NdJ("click",function(){return s.getPrintData()}),e._uU(89),e.ALo(90,"translate"),e.qZA()()()),2&n&&(e.Q6J("pTooltip",e.lcZ(1,31,"composer.header.calculateCostBtn")),e.xp6(2),e.Q6J("visible",s.costDialogVisible)("ngStyle",e.VKq(61,Ke,s.getDir())),e.xp6(2),e.hij(" ",e.lcZ(5,33,"composer.header.calculateCost.title")," "),e.xp6(9),e.hij("",e.lcZ(14,35,"composer.header.calculateCost.officeName")," :"),e.xp6(3),e.Oqu(null==s.costObject?null:s.costObject.officeName),e.xp6(3),e.hij("",e.lcZ(20,37,"composer.header.calculateCost.date")," :"),e.xp6(3),e.Oqu(null==s.costObject?null:s.costObject.date),e.xp6(3),e.hij("",e.lcZ(26,39,"composer.header.calculateCost.time")," :"),e.xp6(3),e.Oqu(null==s.costObject?null:s.costObject.time),e.xp6(3),e.hij("",e.lcZ(32,41,"composer.header.calculateCost.wordPrice")," :"),e.xp6(3),e.Oqu(null==s.costObject?null:s.costObject.wordPrice),e.xp6(3),e.hij("",e.lcZ(38,43,"composer.header.calculateCost.planName")," :"),e.xp6(3),e.Oqu(null==s.costObject?null:s.costObject.planName),e.xp6(3),e.hij("",e.lcZ(44,45,"composer.header.calculateCost.totalCost")," :"),e.xp6(3),e.Oqu(null==s.costObject?null:s.costObject.totalcost),e.xp6(4),e.hij("",e.lcZ(51,47,"composer.header.calculateCost.addedPrice")," :"),e.xp6(3),e.Oqu((null==s.costObject?null:s.costObject.addedPrice)||0),e.xp6(3),e.hij("",e.lcZ(57,49,"composer.header.calculateCost.urgentPrice")," :"),e.xp6(3),e.Oqu((null==s.costObject?null:s.costObject.urgentPrice)||0),e.xp6(3),e.hij("",e.lcZ(63,51,"composer.header.calculateCost.templatePrice")," :"),e.xp6(2),e.Oqu((null==s.costObject?null:s.costObject.templatePrice)||0),e.xp6(4),e.hij("",e.lcZ(69,53,"composer.header.calculateCost.decorationPrice")," :"),e.xp6(3),e.Oqu((null==s.costObject?null:s.costObject.decorationPrice)||0),e.xp6(3),e.hij("",e.lcZ(75,55,"composer.header.calculateCost.smsPrice")," :"),e.xp6(3),e.Oqu((null==s.costObject?null:s.costObject.smsprice)||0),e.xp6(3),e.hij("",e.lcZ(81,57,"composer.header.calculateCost.deliveryPrice")," :"),e.xp6(3),e.Oqu((null==s.costObject?null:s.costObject.deliveryPrice)||0),e.xp6(1),e.Q6J("value",s.costObject.messages)("tableStyle",e.DdM(63,ze)),e.xp6(5),e.hij(" ",e.lcZ(90,59,"composer.header.calculateCost.printCost")," "))},dependencies:[p.PC,v.jx,x.iA,Ge.V,F.u,m.X$],styles:["p-table{text-align:center}"]})}return i})();var Xe=c(2200),et=c(3161);const tt=["draftsModal"];function nt(i,a){1&i&&e.GkF(0)}function st(i,a){1&i&&(e.TgZ(0,"tr")(1,"th"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e._UZ(28,"th"),e.qZA()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,9,"composer.header.getDrafts.genId")),e.xp6(3),e.Oqu(e.lcZ(6,11,"composer.header.getDrafts.user")),e.xp6(3),e.Oqu(e.lcZ(9,13,"composer.header.getDrafts.telNo")),e.xp6(3),e.Oqu(e.lcZ(12,15,"composer.header.getDrafts.billTel")),e.xp6(3),e.Oqu(e.lcZ(15,17,"composer.header.getDrafts.msg")),e.xp6(3),e.Oqu(e.lcZ(18,19,"composer.header.getDrafts.draftDate")),e.xp6(3),e.Oqu(e.lcZ(21,21,"composer.header.getDrafts.callDate")),e.xp6(3),e.Oqu(e.lcZ(24,23,"composer.header.getDrafts.callerName")),e.xp6(3),e.Oqu(e.lcZ(27,25,"composer.header.getDrafts.notes")))}function it(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td")(18,"button",18),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.selectDraft(o))}),e._uU(19),e.ALo(20,"translate"),e.qZA()()()}if(2&i){const t=a.$implicit;e.xp6(2),e.Oqu(t.genId),e.xp6(2),e.Oqu(t.userCode),e.xp6(2),e.Oqu(t.callerTelNo),e.xp6(2),e.Oqu(t.message),e.xp6(2),e.Oqu(t.draftDate),e.xp6(2),e.Oqu(t.callDate),e.xp6(2),e.Oqu(t.callerName),e.xp6(2),e.Oqu(t.notes),e.xp6(3),e.hij(" ",e.lcZ(20,9,"composer.header.getDrafts.open")," ")}}const P=function(){return{standalone:!0}},ot=function(){return{"min-width":"50rem"}};function rt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"p-radioButton",7),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.searchByTel=s)})("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.changeSearchOptionInDraft(s))}),e.qZA(),e.TgZ(4,"label",8),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"div",6)(8,"p-radioButton",9),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.searchByTel=s)})("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.changeSearchOptionInDraft(s))}),e.qZA(),e.TgZ(9,"label",10),e._uU(10),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"input",11),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.searchByTelNo=s)}),e.qZA(),e.TgZ(13,"button",12),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.getDrafts())}),e._uU(14," Search "),e.qZA(),e.TgZ(15,"div",13)(16,"p-checkbox",14),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.draftsFlags.messageFlag=s)}),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"p-checkbox",14),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.draftsFlags.recFlag=s)}),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"p-checkbox",14),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.draftsFlags.senderFlag=s)}),e.ALo(21,"translate"),e.qZA()()(),e.TgZ(22,"p-table",15),e.YNc(23,st,29,27,"ng-template",16),e.YNc(24,it,21,11,"ng-template",17),e.qZA()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.searchByTel),e.xp6(2),e.Oqu(e.lcZ(6,22,"composer.header.getDrafts.telNo")),e.xp6(3),e.Q6J("ngModel",t.searchByTel),e.xp6(2),e.Oqu(e.lcZ(11,24,"composer.header.getDrafts.userCode")),e.xp6(2),e.Q6J("readonly","userCode"==t.searchByTel)("ngModel",t.searchByTelNo)("placeholder",t.searchByTel?"Tel No":t.user),e.xp6(1),e.Q6J("disabled","telNo"==t.searchByTel&&!t.searchByTelNo),e.xp6(3),e.Q6J("ngModel",t.draftsFlags.messageFlag)("ngModelOptions",e.DdM(32,P))("binary",!0)("label",e.lcZ(17,26,"composer.header.getDrafts.copyMsgContent")),e.xp6(2),e.Q6J("ngModel",t.draftsFlags.recFlag)("ngModelOptions",e.DdM(33,P))("binary",!0)("label",e.lcZ(19,28,"composer.header.getDrafts.copyRec")),e.xp6(2),e.Q6J("ngModel",t.draftsFlags.senderFlag)("ngModelOptions",e.DdM(34,P))("binary",!0)("label",e.lcZ(21,30,"composer.header.getDrafts.copySenders")),e.xp6(2),e.Q6J("value",t.draftsData)("tableStyle",e.DdM(35,ot))}}let at=(()=>{class i{constructor(t,n,s,o,r,d,h){this.toastService=t,this.translate=n,this.composerService=s,this.sectionData=o,this.sharedService=r,this.sectionVariables=d,this.permissionsService=h,this.createBody={},this.draftsFlags={recFlag:!0,senderFlag:!1,messageFlag:!0},this.user="",this.telNo=null,this.setDraft=new e.vpe}openModal(){this.draftsModal.clickOnButton("open")}ngOnInit(){this.createBody=this.sectionVariables.createBody,this.user=this.permissionsService.getUserName(),this.searchByTelNo=this.user,this.searchByTel="userCode"}resetDraftsModal(){this.draftsFlags={recFlag:!0,senderFlag:!1,messageFlag:!0},this.draftsData=[],this.draftsModal.clickOnButton("close")}changeSearchOptionInDraft(t){"telNo"==t?(this.user=null,this.searchByTelNo=null):(this.user=this.permissionsService.getUserName(),this.searchByTelNo=this.user)}selectDraft(t){let s={...this.draftsFlags,genId:t.genId};this.sharedService.convertBoolToInt(s),this.composerService.post("DraftByGenId",s).subscribe({next:o=>{this.genId=o?.body?.genId,this.setDraftData(o.body),this.draftsModal.clickOnButton("close"),this.draftsFlags={recFlag:!0,senderFlag:!1,messageFlag:!0}},error:o=>{this.toastService.showError("Failed Fetching Draft")},complete:()=>{this.draftsData=[]}})}setDraftData(t){this.setDraft.emit(t)}getDrafts(){this.user=this.permissionsService.getUserName(),this.createBody=this.createInitObject(),"telNo"==this.searchByTel?this.telNo=this.searchByTelNo:(this.user=this.permissionsService.getUserName(),this.telNo=null,this.searchByTelNo=this.user),this.composerService.getChangeData(`getTghDraft?user=${this.user}&telNo=${this.telNo}`).subscribe({next:t=>{this.draftsData=t.body},error:t=>{this.toastService.showError("Failed Fetching Drafts")},complete:()=>{}})}createInitObject(){let t=this.sectionData.getMessageForm.getRawValue(),n=this.sectionData.getTghDetailsForm.getRawValue(),s={senders:JSON.parse(JSON.stringify(this.sectionData.senders))},o={recepients:JSON.parse(JSON.stringify(this.sectionData.recepients))};this.genId=this.sectionVariables.genId,n.userCode=this.user,this.sharedService.handleRecepients(o.recepients),this.handleTghDetailsForm(n);let r=this.genId;return{...t,...n,...s,...o,genId:r}}handleTghDetailsForm(t){t.countryCode=t?.countryCode?.countryCode}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(M.k),e.Y36(m.sK),e.Y36(g),e.Y36(T),e.Y36(q),e.Y36(L),e.Y36(N.q))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-draft"]],viewQuery:function(n,s){if(1&n&&e.Gf(tt,5),2&n){let o;e.iGM(o=e.CRH())&&(s.draftsModal=o.first)}},outputs:{setDraft:"setDraft"},decls:5,vars:6,consts:[[3,"size","modal_name","action_name","cancel_name","header_name","action_canceled"],["draftsModal",""],[4,"ngTemplateOutlet"],["myComponent",""],[1,"d-flex","align-items-center","mb-3"],[2,"display","flex","justify-content","space-around","margin","15px"],[1,"align-items-center",2,"margin","5px"],["name","pizza","value","telNo","inputId","ingredient1",3,"ngModel","ngModelChange"],["for","ingredient1",1,"m-1"],["name","pizza","value","userCode","inputId","ingredient2",3,"ngModel","ngModelChange"],["for","ingredient2",1,"m-1"],["type","text","id","telNo",1,"form-control","me-3",2,"width","unset","width","20% !important",3,"readonly","ngModel","placeholder","ngModelChange"],["type","submit",1,"btn","btn-primary","me-3",3,"disabled","click"],[1,"draft-checkboxes"],["inputId","binary",3,"ngModel","ngModelOptions","binary","label","ngModelChange"],["selectionMode","single","dataKey","code",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["type","button",1,"btn","btn-primary","btn-sm","mx-2",3,"click"]],template:function(n,s){if(1&n&&(e.TgZ(0,"mts-modal",0,1),e.NdJ("action_canceled",function(){return s.resetDraftsModal()}),e.YNc(2,nt,1,0,"ng-container",2),e.qZA(),e.YNc(3,rt,25,36,"ng-template",null,3,e.W1O)),2&n){const o=e.MAs(4);e.Q6J("size","modal-xl")("modal_name","draftsModal")("action_name","None")("cancel_name",s.translate.instant("composer.header.getDrafts.close"))("header_name",s.translate.instant("composer.header.getDrafts.title")),e.xp6(2),e.Q6J("ngTemplateOutlet",o)}},dependencies:[p.tP,l.Fj,l.JJ,l.On,v.jx,x.iA,Xe.EU,et.XZ,Q.z,m.X$]})}return i})();const lt=["TelegraphDetailsComponent"],ct=["RecepientsComponent"],dt=["SendersComponent"],pt=["MessageDetailsComponent"],ht=["dailyReport"],gt=["draft"],mt=["closeModal"];function ut(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.openDailyReport())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"composer.header.dailyReportBtn")," "))}let ft=(()=>{class i{constructor(t,n,s,o,r,d,h,f,u,w){this.composerService=t,this.toastService=n,this.router=s,this.translate=o,this.sharedService=r,this.printService=d,this.permissionsService=h,this.sectionVariables=f,this.sectionsDataService=u,this.lang=w,this.costObject=[],this.costDialogVisible=!1,this.isInOffice=!1,this.printList=[],this.newDate=new Date,this.searchByTel="userCode",this.canFinish=!1}ngOnInit(){this.onCreate(),[this.canViewDailyReport,this.canFinish]=this.permissionsService.havePermissions(["TghDailyReportDesktop.view","TghGeneratorDesktop.create"])}onCreate(){this.getInitData(),this.createBody=this.sectionVariables.createBody,this.composerService.isInOffice.subscribe(t=>{this.isInOffice=t}),this.telNo=this.sectionVariables.telNo,this.costDialogVisible=this.sectionVariables.costDialogVisible,this.composerService._isEdited=!1}loginAsOffice(){localStorage.setItem("username","office username"),localStorage.setItem("originOffice","TKH"),this.refresh()}loginAsCallCenter(){localStorage.setItem("username","callCenter username"),localStorage.setItem("originOffice","TLG"),this.refresh()}getDir(){this.sharedService.getDir()}getInitData(){this.composerService.getChangeData("IntiateTGH").subscribe({next:t=>{this.genId=t.body.getGenId,this.callDate=t.body.callDate,this.sectionVariables.genId=this.genId,this.initiateData=t.body,this.composerService.cities.next(t.body.cities)},error:t=>{},complete:()=>{}})}getPrintData(){this.printService.getPrintData(this.sectionVariables.printCostObj)}setDraftData(t){this.TelegraphDetailsComponent.setDraftData(t),this.MessageDetailsComponent.setDraftData(t),this.RecepientsComponent.setDraftData(t.recepients),this.SendersComponent.setDraftData(t.senders)}saveDraft(){this.createBody=this.draft?.createInitObject(),this.createBody=this.sharedService.handlePostObject(this.createBody),this.postTgh(this.createBody,"TGHDraft")}createTgh(){if(this.canFinish)if(this.createBody=this.draft?.createInitObject(),this.createBody=this.sharedService.handlePostObject(this.createBody),this.sharedService.checkRequiredValidations(this.createBody))if(this.sharedService.isValidFields(this.createBody)){let t={...this.createBody,genId:this.genId};this.postTgh(t,"TGHGenerator")}else this.toastService.showError("Incorrect Values");else this.toastService.showError("Enter Valid Data"),this.sharedService.removeValidations(this.sectionVariables.requiredValidations,2e4);else{let t="en"==this.lang.get_app_lang()?"You Don't Have Permission To Create Telegraphs":"\u0644\u064a\u0633 \u0644\u062f\u064a\u0643 \u0635\u0644\u0627\u062d\u064a\u0629 \u0644\u0625\u0646\u0634\u0627\u0621 \u0628\u0631\u0642\u064a\u0627\u062a";this.toastService.showWarning(t)}}postTgh(t,n){let s={...t,senders:t?.senders,recepients:t?.recepients};s.sendDate=this.TelegraphDetailsComponent.sendDate,s.sendDate=new p.uU("en-US").transform(s.sendDate,"yyyy-MM-dd")?.toString(),s.callDate=this.callDate.split(" ")[0]+" "+new Date(this.callDate).toTimeString().split(" ")[0],console.log("Tgh Body"),console.log(s),this.composerService.post(`${n}`,s).subscribe({next:o=>{"TGHGenerator"===n&&"OK"==o.status?(this.tghSavedSuccessfully(),setTimeout(()=>{this.composerService._isEdited=!1,this.router.navigate([`/composer/composer-finish/${o.body.genId}`])},1e3)):"TGHDraft"===n&&"OK"==o.status&&this.tghSavedSuccessfully()},error:o=>{this.toastService.showError(424===o?.error?.statusCode?o?.error?.clientMessage:"Unknown Error")},complete:()=>{this.sharedService.removeValidations(this.sectionVariables.requiredValidations,1e4)}})}refresh(){window.location.reload()}openDailyReport(){this.dailyReport?.getUsers()}openDraftModal(){this.draft.openModal()}ngOnDestroy(){this.sharedService.removeValidations(this.sectionVariables.requiredValidations,0),this.sectionsDataService.clear()}tghSavedSuccessfully(){this.toastService.showSuccess("Tgh Saved Successfully")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g),e.Y36(M.k),e.Y36(_.F0),e.Y36(m.sK),e.Y36(q),e.Y36(U),e.Y36(N.q),e.Y36(L),e.Y36(T),e.Y36(K.T))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-composer"]],viewQuery:function(n,s){if(1&n&&(e.Gf(lt,5),e.Gf(ct,5),e.Gf(dt,5),e.Gf(pt,5),e.Gf(ht,5),e.Gf(gt,5),e.Gf(mt,5)),2&n){let o;e.iGM(o=e.CRH())&&(s.TelegraphDetailsComponent=o.first),e.iGM(o=e.CRH())&&(s.RecepientsComponent=o.first),e.iGM(o=e.CRH())&&(s.SendersComponent=o.first),e.iGM(o=e.CRH())&&(s.MessageDetailsComponent=o.first),e.iGM(o=e.CRH())&&(s.dailyReport=o.first),e.iGM(o=e.CRH())&&(s.draft=o.first),e.iGM(o=e.CRH())&&(s.closeModalBtn=o.first)}},decls:33,vars:19,consts:[[1,"scroll-div",2,"background-color","#c8b9b91c"],[1,"custom-container",2,"width","100%"],[1,"col-lg-8","col-md-12","col-sm-12","icon-container"],[1,"flex-btns"],["class","btn btn-secondary btn-sm mx-2","type","button",3,"click",4,"ngIf"],[1,"icons-container"],[1,"fa-regular","fa-folder-plus",3,"pTooltip","click"],[1,"fa","fa-plus",3,"pTooltip","click"],["type","button",1,"btn","btn-success","btn-sm","mx-2",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","mx-2",3,"click"],[2,"padding-top","40px"],[3,"genId","callDate","countries"],["TelegraphDetailsComponent",""],[3,"viewOverlay"],["RecepientsComponent",""],[3,"tempeleteTypeList"],["MessageDetailsComponent",""],["SendersComponent",""],["dailyReport",""],[3,"setDraft"],["draft",""],["src","assets/images/weLogo.jpg",2,"width","150px","height","50px","overflow-clip-margin","content-box","overflow","clip","margin-bottom","40px","display","none"],["type","button",1,"btn","btn-secondary","btn-sm","mx-2",3,"click"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div"),e.YNc(5,ut,3,3,"button",4),e.qZA(),e.TgZ(6,"div",5),e._UZ(7,"app-calculate-cost"),e.TgZ(8,"i",6),e.NdJ("click",function(){return s.openDraftModal()}),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"i",7),e.NdJ("click",function(){return s.refresh()}),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"div")(13,"button",8),e.NdJ("click",function(){return s.createTgh()}),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"button",9),e.NdJ("click",function(){return s.saveDraft()}),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()(),e.TgZ(19,"div",10),e._UZ(20,"app-telegraph-details",11,12)(22,"app-recepients",13,14)(24,"app-message-details",15,16)(26,"app-senders",13,17),e.qZA()(),e._UZ(28,"app-daily-report",null,18),e.TgZ(30,"app-draft",19,20),e.NdJ("setDraft",function(r){return s.setDraftData(r)}),e.qZA(),e._UZ(32,"img",21)),2&n&&(e.xp6(5),e.Q6J("ngIf",s.canViewDailyReport),e.xp6(3),e.Q6J("pTooltip",e.lcZ(9,11,"composer.header.getDraftsBtn")),e.xp6(2),e.Q6J("pTooltip",e.lcZ(11,13,"composer.header.newComposer")),e.xp6(4),e.hij(" ",e.lcZ(15,15,"composer.header.finish")," "),e.xp6(3),e.hij(" ",e.lcZ(18,17,"composer.header.saveDraft")," "),e.xp6(3),e.Q6J("genId",s.genId)("callDate",s.callDate)("countries",null==s.initiateData?null:s.initiateData.countries),e.xp6(2),e.Q6J("viewOverlay",s.canFinish),e.xp6(2),e.Q6J("tempeleteTypeList",null==s.initiateData?null:s.initiateData.template_Type),e.xp6(2),e.Q6J("viewOverlay",s.canFinish))},dependencies:[p.O5,F.u,te,Ae,Ne,Ee,Qe,We,at,m.X$],styles:[".scroll-div app-recepients *{font-size:10px!important}  chevrondownicon{margin:0 1rem}  .disableAll{pointer-events:none!important;opacity:.75!important;cursor:not-allowed}.scroll-div[_ngcontent-%COMP%]{width:100%}.flex-btns[_ngcontent-%COMP%]{display:flex;margin:1rem;justify-content:space-between;direction:inherit}  .icon-container{direction:ltr}  .icons-container{border:none;border-right:.5px solid #16a34a;border-left:.5px solid #16a34a}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{margin:0}  .p-accordion .p-accordion-content{padding:1px}  .p-datatable-scrollable>.p-datatable-wrapper{position:relative;z-index:0}  .p-datepicker:not(.p-datepicker-inline){background:#ffffff;z-index:9999!important;border:0 none;box-shadow:0 2px 12px #0000001a}  .p-checkbox-label{margin:0 5px}  .icons-container:last-child{border-right:none;border-left:none}  .icons-container:last-child button:first-child{margin-right:5px}  .icon-container .flex div i,   .icon-container i{font-size:2rem!important;color:#858585;margin:0 6px;cursor:pointer}.tatal-cost[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-weight:700;width:40%!important}.cost-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:5px}.cost-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{font-weight:bolder}.danger-border[_ngcontent-%COMP%]{border:1px solid red}.draft-checkboxes[_ngcontent-%COMP%]   p-checkbox[_ngcontent-%COMP%]{margin:10px}  .p-toast .p-toast-message .p-toast-message-content .p-toast-summary,   .p-toast .p-toast-message .p-toast-message-content .p-toast-detail{font-size:14px!important}.content[_ngcontent-%COMP%]{width:89%;border:1px solid gray;margin:30px 10px;height:100%;padding:60px 100px;direction:ltr}.content-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;direction:rtl;width:45%}.custom-container[_ngcontent-%COMP%]{position:fixed;z-index:1;top:52px;background-color:#efefef;padding-bottom:0;background-attachment:fixed;box-shadow:2px -8px 18px gray;direction:inherit;justify-content:center}  .p-accordion .p-accordion-toggle-icon{transform:rotate(180deg)!important;margin:0 .5rem!important}  .p-accordion .p-accordion-tab-active .p-accordion-toggle-icon{transform:rotate(0)!important}  .p-float-label textarea.p-filled~label{top:-1.25rem!important}"]})}return i})();var _t=c(4973);const Ct=[{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed num 20",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"ahmed",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"},{userCode:"lasssssssssst",genId:1231,sendDate:"29-5-2023",tghCost:"25 PT",tghCode:141233,office:"TKH"}],xt=["TelegraphDetailsComponent"],yt=["RecepientsComponent"],bt=["SendersComponent"],Tt=["MessageDetailsComponent"],vt=["closeModal"];function Dt(i,a){1&i&&(e.TgZ(0,"h1",14),e._uU(1," \u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u064a\u0648\u0645\u064a (BSI) "),e.qZA())}function Zt(i,a){if(1&i&&(e.TgZ(0,"tr")(1,"td",8),e._uU(2),e.qZA(),e.TgZ(3,"td",8),e._uU(4),e.qZA(),e.TgZ(5,"td",8),e._uU(6),e.qZA(),e.TgZ(7,"td",8),e._uU(8),e.qZA(),e.TgZ(9,"td",8),e._uU(10),e.qZA(),e.TgZ(11,"td",8),e._uU(12),e.qZA(),e.TgZ(13,"td",8),e._uU(14),e.qZA()()),2&i){const t=a.$implicit,n=a.index;e.xp6(2),e.hij(" ",t.office," "),e.xp6(2),e.hij(" ",t.tghCode," "),e.xp6(2),e.hij(" ",t.tghCost," "),e.xp6(2),e.hij(" ",t.sendDate," "),e.xp6(2),e.hij(" ",t.genId," "),e.xp6(2),e.hij(" ",t.userCode," "),e.xp6(2),e.hij(" ",n+1," ")}}function Mt(i,a){1&i&&(e.TgZ(0,"h2",15),e._uU(1," \u0627\u0644\u0645\u0628\u0644\u063a \u0627\u0644\u0643\u0644\u0649 : 61815.00 \u0642\u0631\u0634\u0627 "),e.qZA())}function wt(i,a){if(1&i&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div"),e._UZ(3,"img",3),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,Dt,2,0,"h1",5),e.qZA()(),e.TgZ(6,"table",6)(7,"tr",7)(8,"th",8),e._uU(9,"\u0627\u0644\u0645\u0643\u062a\u0628"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0623\u0635\u0644\u064a"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"\u0627\u0644\u062a\u0643\u0644\u0641\u0629"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0627\u0631\u0633\u0627\u0644"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"\u0631\u0642\u0645 \u0627\u0644\u0628\u0631\u0642\u064a\u0629"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"\u0645"),e.qZA()(),e.YNc(22,Zt,15,7,"tr",9),e.qZA(),e.YNc(23,Mt,2,0,"h2",10),e.TgZ(24,"div",11)(25,"h3",12)(26,"span",13),e._uU(27,"Sunday, 11 June, 2023 12:07:46"),e.qZA(),e._uU(28," \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0637\u0628\u0627\u0639\u0629 "),e.qZA(),e.TgZ(29,"h3",12),e._uU(30),e.qZA()()()),2&i){const t=a.$implicit,n=a.index,s=e.oxw();e.xp6(5),e.Q6J("ngIf",0==n),e.xp6(17),e.Q6J("ngForOf",null==t?null:t.pageContent),e.xp6(1),e.Q6J("ngIf",n==s.pages.length-1),e.xp6(7),e.AsE(" Page ",null==t?null:t.pageNumber," / ",s.pages.length," ")}}let Ot=(()=>{class i{constructor(t,n,s){this.composerService=t,this.router=n,this.toastService=s,this.costObject=[],this.sender="",this.rec="",this.draftVisiblePopup=!1,this.disableTableCost=!1,this.draftsFlags={recFlag:!0,senderFlag:!1,messageFlag:!0},this.lineInfoVisiable=!1,this.user="",this.pages=[],this.data=Ct,this.handleDailogsShow={costCalcDailog:!1,draftDailog:!1},this.searchByTel="userCode",this.telNo=null,this.validStatus=!0,this.lineInfo={balance:0,paidmod:"",statues:1};let o=this.data.length/20,r=0;for(let d=0;d<o;d++)this.pages.push({pageNumber:d+1,pageContent:this.data.slice(r,r+20)}),r+=20}ngAfterViewInit(){}ngOnInit(){this.user=localStorage.getItem("username")||"success",this.searchByTelNo=this.user,this.telNo=null,this.getInitData()}getInitData(){this.composerService.getChangeData("IntiateTGH").subscribe({next:t=>{this.genId=t.body.getGenId,this.allData=t.body,this.composerService.cities.next(t.body.cities)}})}openCostCalcPopup(){this.handleDailogsShow.costCalcDailog=!0,this.calCostObject()}calCostObject(){let t=this.MessageDetailsComponent.messageForm.getRawValue();this.handleMessageFlags(),this.costObject={planCode:this.TelegraphDetailsComponent.tghDetailsForm.controls.planCode.value,senders:JSON.parse(JSON.stringify(this.SendersComponent.senders)),recepients:JSON.parse(JSON.stringify(this.RecepientsComponent.recepients)),template:this.MessageDetailsComponent.messageForm.controls.template.value,delivery:this.MessageDetailsComponent.messageForm.controls.deliveryNotic.value,decoration:this.MessageDetailsComponent.messageForm.controls.decoration.value,message:t.message,urgent:this.MessageDetailsComponent.messageForm.controls.urgent.value,sms:this.MessageDetailsComponent.messageForm.controls.sms.value},this.removeIds(this.costObject.recepients),this.removeIds(this.costObject.senders),this.checkRequiredFeilds()}removeIds(t){t.forEach(n=>{delete n.id,delete n.officeName})}checkRequiredFeilds(){this.costObject.message&&null!=this.costObject.message?(this.disableTableCost=!1,this.getCostMessage()):this.disableTableCost=!0}encodebooleanToInteger(t){t=t.map(n=>{let s=n;return s.senderResp=s.senderResp?1:0,s.recVip=s.recVip?1:0,s})}handleRecepients(t){t?.map(n=>{"object"==typeof n.address&&(n.address=n?.address?.keywordName),n.senderResp=n.senderResp?1:0,n.recVip=n.recVip?1:0,n.cityCode=n.cityCode?.cityCode?n.cityCode?.cityCode:null})}getCostMessage(){console.log("messaage"),this.handleRecepients(this.costObject.recepients),this.composerService.post("calculateMsgCost",this.costObject).subscribe({next:t=>{this.costObject=t.body},error:t=>{},complete:()=>{}})}showDrafts(){this.handleDailogsShow.draftDailog=!0,this.createInitObject(),this.getDrafts()}changeSearchValueForDrafts(t){"telNo"==t?(this.user=null,this.searchByTelNo=null):(this.user=localStorage.getItem("username")||"success",this.searchByTelNo=this.user)}getDrafts(){"telNo"==this.searchByTel?(this.user=null,this.telNo=this.searchByTelNo):(this.user=localStorage.getItem("username")||"success",this.telNo=null,this.searchByTelNo=this.user),this.composerService.getChangeData(`getTghDraft?user=${this.user}&telNo=${this.telNo}`).subscribe(t=>{this.draftsData=t.body})}handleBooleanToBinary(t){return Object.keys(t).forEach(n=>{"string"!=typeof t[n]&&(0==t[n]?t[n]=0:1==t[n]&&(t[n]=1))}),t}handleDraftObject(t,n=!1){return n&&(t=Object.assign({},t)),this.encodebooleanToInteger(t?.recepients),this.handleBooleanToBinary(t)}saveDraft(){this.createInitObject(),this.createBody=this.handleDraftObject(this.createBody),this.removeIdsFromObject(this.createBody,"TGHDraft",!1)}getDraft(){this.selectDraft({genId:23373140,callDate:"2023-06-04",notes:null,message:null,draftDate:"2023-06-04",callerTelNo:null,userCode:"success",callerName:null,billTelNo:null})}selectDraft(t){let s={...this.draftsFlags,genId:t.genId};this.handleBooleanToBinary(s),this.composerService.post("DraftByGenId",s).subscribe({next:o=>{let r=o.body;this.closeModalBtn.nativeElement.click(),this.TelegraphDetailsComponent.setDraftData(r),this.MessageDetailsComponent.setDraftData(r),this.RecepientsComponent.setDraftData(r.recepients),this.SendersComponent.setDraftData(r.senders),this.handleDailogsShow.draftDailog=!1,this.draftsFlags={recFlag:!0,senderFlag:!1,messageFlag:!0}},error:o=>{},complete:()=>{this.draftsData=[]}})}hideDraftList(){this.draftsFlags={recFlag:!0,senderFlag:!1,messageFlag:!0},this.draftsData=[]}newComposer(){window.location.reload()}removeIdsFromObject(t,n,s){let o=t?.senders?.map(({id:h,...f})=>f),r=t?.recepients?.map(({id:h,...f})=>f),d={...t,senders:o,recepients:r};Date.parse(d.sendDate),d.sendDate=this.TelegraphDetailsComponent.sendDate,this.composerService.post(`${n}`,d).subscribe(h=>{this.draftVisiblePopup=!0,s&&"OK"==h.status?(this.draftSavedMessage=h.body.clientMessage,setTimeout(()=>{this.router.navigate([`/composer/composer-finish/${h.body.genId}`])},3e3)):this.draftSavedMessage=h.clientMessage})}createTgh(){this.createInitObject(),this.postTgh()}handleMessageFlags(){["sms","deliveryNotic","urgent","template"].map(n=>{this.MessageDetailsComponent.patchFormControl(n,!0===this.MessageDetailsComponent.messageForm.controls[n].value?1:0)})}createInitObject(){let t=this.MessageDetailsComponent.messageForm.getRawValue(),n=this.TelegraphDetailsComponent.tghDetailsForm.getRawValue(),s={senders:JSON.parse(JSON.stringify(this.SendersComponent.senders))},o={recepients:JSON.parse(JSON.stringify(this.RecepientsComponent.recepients))};n.userCode="success";let r=this.genId;this.handleRecepients(o.recepients),this.createBody={...t,...n,...s,...o,genId:r}}nullOrUndefined(t){if(null==t||null==t||""==t)return!0}chechValidations(){this.validStatus=!0,this.nullOrUndefined(this.createBody.message)&&(this.composerService.setValidation("msg",!0),this.validStatus=!1),this.nullOrUndefined(this.createBody.callerName)&&(this.composerService.setValidation("callerName",!0),this.validStatus=!1),(0==this.createBody.senders.length||0==this.createBody.recepients.length)&&(this.validStatus=!1);for(let t=0;t<this.createBody.senders.length;t++)this.nullOrUndefined(this.createBody.senders[t].senderName)&&(this.composerService.setValidation("senName",!0),this.validStatus=!1);for(let t=0;t<this.createBody.recepients.length;t++)this.nullOrUndefined(this.createBody.recepients[t].recName)&&(this.composerService.setValidation("recName",!0),this.composerService.setValidation("recAddress",!0),this.validStatus=!1);return this.validStatus}postTgh(){if(this.createBody=this.handleDraftObject(this.createBody),this.createBody.admin=this.createBody.admin?1:0,this.createBody.international=this.createBody.international?1:0,this.chechValidations()){let t={...this.lineInfo,...this.createBody,genId:this.genId};this.encodebooleanToInteger(t.recepients),this.removeIdsFromObject(t,"TGHGenerator",!0)}else this.draftVisiblePopup=!0,this.draftSavedMessage="Please enter a valid telegraph "}getLineInfo(){this.lineInfoVisiable=!0;let t=this.TelegraphDetailsComponent.tghDetailsForm.controls.billTelNo.value;null!=t&&t&&t.startsWith("0")?(this.lineInfoData=!0,this.composerService.getChangeData(`GetLineInfo?serviceNumber=${t}`).subscribe(n=>{this.lineInfo=n.body})):this.lineInfoData=!1}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g),e.Y36(_.F0),e.Y36(M.k))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-composer-header"]],viewQuery:function(n,s){if(1&n&&(e.Gf(xt,5),e.Gf(yt,5),e.Gf(bt,5),e.Gf(Tt,5),e.Gf(vt,5)),2&n){let o;e.iGM(o=e.CRH())&&(s.TelegraphDetailsComponent=o.first),e.iGM(o=e.CRH())&&(s.RecepientsComponent=o.first),e.iGM(o=e.CRH())&&(s.SendersComponent=o.first),e.iGM(o=e.CRH())&&(s.MessageDetailsComponent=o.first),e.iGM(o=e.CRH())&&(s.closeModalBtn=o.first)}},decls:1,vars:1,consts:[["style","\n    height: 800px;\n    margin: 20px 30px;\n    display: flex;\n    flex-direction: column;\n  ",4,"ngFor","ngForOf"],[2,"height","800px","margin","20px 30px","display","flex","flex-direction","column"],[2,"margin-bottom","50px"],["src","../../../../assets/images/CustomerLogo.jpg"],[2,"display","flex","justify-content","center"],["style","font-size: 22px !important",4,"ngIf"],[2,"margin-bottom","50px","font-size","25px !important"],[2,"border-bottom","1px solid","font-size","25px !important"],[2,"text-align","center"],[4,"ngFor","ngForOf"],["style","font-size: 20px !important; direction: rtl; margin-bottom: 50px",4,"ngIf"],[1,"footer",2,"display","flex","justify-content","space-around","margin-right","500px","font-size","15px !important","margin-bottom","50px"],[2,"font-size","15px !important"],[2,"margin","0 10px","font-size","15px !important"],[2,"font-size","22px !important"],[2,"font-size","20px !important","direction","rtl","margin-bottom","50px"]],template:function(n,s){1&n&&e.YNc(0,wt,31,5,"div",0),2&n&&e.Q6J("ngForOf",s.pages)},dependencies:[p.sg,p.O5],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center}.icon-container[_ngcontent-%COMP%]{direction:ltr}.icons-container[_ngcontent-%COMP%]{border:none;border-right:.5px solid #16a34a;border-left:.5px solid #16a34a}  .p-accordion .p-accordion-content{padding:1px}  .p-datatable-scrollable>.p-datatable-wrapper{position:relative;z-index:0}.icons-container[_ngcontent-%COMP%]:last-child{border-right:none;border-left:none}.icons-container[_ngcontent-%COMP%]:last-child   button[_ngcontent-%COMP%]:first-child{margin-right:5px}.icon-container[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .icon-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem!important;color:#858585;margin:0 6px;cursor:pointer}.btn[_ngcontent-%COMP%]{padding:5px 10px}.tatal-cost[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-weight:700;width:40%!important}.cost-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:5px}.cost-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{font-weight:bolder}.danger-border[_ngcontent-%COMP%]{border:1px solid red}.draft-checkboxes[_ngcontent-%COMP%]   p-checkbox[_ngcontent-%COMP%]{margin:10px}"]})}return i})();var At=c(8530),Nt=c(2818);const Ft=function(){return{standalone:!0}};function St(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",10)(2,"p-multiSelect",11),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedColumns=s)}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("options",t.cols)("ngModel",t.selectedColumns)("ngModelOptions",e.DdM(3,Ft))}}function It(i,a){if(1&i&&(e.TgZ(0,"th",14)(1,"div",15),e._uU(2),e._UZ(3,"p-sortIcon",16),e.qZA()()),2&i){const t=a.$implicit;e.s9C("pSortableColumn",t.field),e.xp6(2),e.hij(" ",t.header," "),e.xp6(1),e.s9C("field",t.field)}}function qt(i,a){if(1&i&&(e.TgZ(0,"th"),e._UZ(1,"p-columnFilter",17),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.s9C("field",t.field)}}function Ut(i,a){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,It,4,3,"th",12),e.qZA(),e.TgZ(2,"tr"),e.YNc(3,qt,2,1,"th",13),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Q6J("ngForOf",t),e.xp6(2),e.Q6J("ngForOf",t)}}function Lt(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.xp6(1),e.hij("",n[t.field]," ")}}function Rt(i,a){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,Lt,2,1,"span",18),e.qZA()),2&i){const t=a.$implicit,n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","null"!==n[t.field])}}function Pt(i,a){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,Rt,2,1,"td",13),e.qZA()),2&i){const t=a.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function Jt(i,a){1&i&&(e.TgZ(0,"tr")(1,"td",19)(2,"h6",20),e._uU(3,"No Data Found"),e.qZA()()())}let G=(()=>{class i{constructor(t,n,s){this.composerService=t,this.activatedRoute=n,this.mtsModules=s,this.loading=!1,this.composerList=[]}ngOnInit(){this.createColumns()}ngAfterViewInit(){this.getActiveRoute()}getActiveRoute(){this.activatedRoute.params.subscribe(t=>{this.getComposerByGenId(t.genId)})}createColumns(){this.cols=this.mtsModules.get_cols_by_fileds_and_headers(["1_seqNo","1_tghCode","1_sendDate","1_tghDate","1_recName","1_senderName","1_status","1_noOfWords","1_tghCost","1_office","1_userCode"],"composerFinish"),this.selectedColumns=this.cols.slice()}getComposerByGenId(t){this.composerService.getChangeData(`ShowTGH?genId=${t}`).subscribe(n=>{this.composerList=n.body})}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g),e.Y36(_.gz),e.Y36(At._))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-composer-finish"]],decls:10,vars:7,consts:[[1,"row"],[1,"my-3","text-center",2,"font-size","20px !important"],[1,"col-lg-12"],["id","tableTelegraphs","sortMode","multiple","scrollHeight","300px;","styleClass","p-datatable-sm p-datatable-gridlines","selectionMode","single","responsiveLayout","scroll","selectionMode","multiple","dataKey","id",1,"table","table-hover",3,"value","columns","scrollable","loading","paginator","globalFilterFields","metaKeySelection"],["tableTelegraphs",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"header-container"],[1,"hader-mul-sel"],["optionLabel","header","selectedItemsLabel","{0} columns selected","placeholder","Choose Columns",1,"multicol",3,"options","ngModel","ngModelOptions","ngModelChange"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"pSortableColumn"],[1,"p-d-flex","p-jc-between","p-ai-center"],[3,"field"],["type","text",3,"field"],[4,"ngIf"],["colspan","100"],[1,"emptymessage"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Teleghraphs Details "),e.qZA(),e.TgZ(3,"div",2)(4,"p-table",3,4),e.YNc(6,St,3,4,"ng-template",5),e.YNc(7,Ut,4,2,"ng-template",6),e.YNc(8,Pt,2,1,"ng-template",7),e.YNc(9,Jt,4,0,"ng-template",8),e.qZA()()()),2&n&&(e.xp6(4),e.Q6J("value",s.composerList)("columns",s.selectedColumns)("scrollable",!0)("loading",s.loading)("paginator",!1)("globalFilterFields",s.cols)("metaKeySelection",!0))},dependencies:[p.sg,p.O5,l.JJ,l.On,v.jx,x.iA,x.lQ,x.fz,x.xl,Nt.NU],styles:[".header-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.header-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-right:10px}"]})}return i})();const jt=[{path:"",component:ft,canDeactivate:[(()=>{class i{constructor(t){this.composerService=t}canDeactivate(){if(this.composerService.isFormEdited())return confirm("Are you sure you want to leave? Your changes will be lost.")}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(g))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()]},{path:"composer-finish",component:G},{path:"composer-finish/:genId",component:G},{path:"test",component:Ot}];let Et=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[_t.m,_.Bz.forChild(jt),m.aw.forChild()]})}return i})()},265:(Y,O,c)=>{c.d(O,{O:()=>y});var p=c(3155),e=c(2029),Z=c(9862);let y=(()=>{class C{constructor(_){this.httpClient=_}get(_){return this.httpClient.get(`${p.D.apiURL}/${_}`)}post(_,g){return this.httpClient.post(`${p.D.apiURL}/${_}`,g)}static#e=this.\u0275fac=function(g){return new(g||C)(e.LFG(Z.eN))};static#t=this.\u0275prov=e.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()}}]);